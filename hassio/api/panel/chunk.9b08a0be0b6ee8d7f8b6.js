(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{134:function(e,t,n){"use strict";n.r(t);n(15),n(14),n(101),n(47),n(102),n(120);var o=n(4),a=n(9),s=(n(35),n(44),n(22)),r=n(21);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['\n      <style include="ha-style hassio-style">\n        paper-radio-group {\n          display: block;\n        }\n        paper-radio-button {\n          padding: 0 0 2px 2px;\n        }\n        paper-radio-button,\n        paper-checkbox,\n        paper-input[type="password"] {\n          display: block;\n          margin: 4px 0 4px 48px;\n        }\n        .pointer {\n          cursor: pointer;\n        }\n      </style>\n      <div class="content">\n        <div class="card-group">\n          <div class="title">\n            Create snapshot\n            <div class="description">\n              Snapshots allow you to easily backup and restore all data of your\n              Hass.io instance.\n            </div>\n          </div>\n          <paper-card>\n            <div class="card-content">\n              <paper-input\n                autofocus=""\n                label="Name"\n                value="{{snapshotName}}"\n              ></paper-input>\n              Type:\n              <paper-radio-group selected="{{snapshotType}}">\n                <paper-radio-button name="full">\n                  Full snapshot\n                </paper-radio-button>\n                <paper-radio-button name="partial">\n                  Partial snapshot\n                </paper-radio-button>\n              </paper-radio-group>\n              <template is="dom-if" if="[[!_fullSelected(snapshotType)]]">\n                Folders:\n                <template is="dom-repeat" items="[[folderList]]">\n                  <paper-checkbox checked="{{item.checked}}">\n                    [[item.name]]\n                  </paper-checkbox>\n                </template>\n                Add-ons:\n                <template\n                  is="dom-repeat"\n                  items="[[addonList]]"\n                  sort="_sortAddons"\n                >\n                  <paper-checkbox checked="{{item.checked}}">\n                    [[item.name]]\n                  </paper-checkbox>\n                </template>\n              </template>\n              Security:\n              <paper-checkbox checked="{{snapshotHasPassword}}"\n                >Password protection</paper-checkbox\n              >\n              <template is="dom-if" if="[[snapshotHasPassword]]">\n                <paper-input\n                  label="Password"\n                  type="password"\n                  value="{{snapshotPassword}}"\n                ></paper-input>\n              </template>\n              <template is="dom-if" if="[[error]]">\n                <p class="error">[[error]]</p>\n              </template>\n            </div>\n            <div class="card-actions">\n              <mwc-button\n                disabled="[[creatingSnapshot]]"\n                on-click="_createSnapshot"\n                >Create</mwc-button\n              >\n            </div>\n          </paper-card>\n        </div>\n\n        <div class="card-group">\n          <div class="title">Available snapshots</div>\n          <template is="dom-if" if="[[!snapshots.length]]">\n            <paper-card>\n              <div class="card-content">You don\'t have any snapshots yet.</div>\n            </paper-card>\n          </template>\n          <template\n            is="dom-repeat"\n            items="[[snapshots]]"\n            as="snapshot"\n            sort="_sortSnapshots"\n          >\n            <paper-card class="pointer" on-click="_snapshotClicked">\n              <div class="card-content">\n                <hassio-card-content\n                  hass="[[hass]]"\n                  title="[[_computeName(snapshot)]]"\n                  description="[[_computeDetails(snapshot)]]"\n                  datetime="[[snapshot.date]]"\n                  icon="[[_computeIcon(snapshot.type)]]"\n                  icon-class="snapshot"\n                ></hassio-card-content>\n              </div>\n            </paper-card>\n          </template>\n        </div>\n      </div>\n    ']);return p=function(){return e},e}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(o){var a=Object.getOwnPropertyDescriptor(o,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,d(t).apply(this,arguments))}var i,f,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,Object(s["a"])(a["a"])),i=t,y=[{key:"template",get:function(){return Object(o.a)(p())}},{key:"properties",get:function(){return{hass:Object,snapshotName:{type:String,value:""},snapshotPassword:{type:String,value:""},snapshotHasPassword:Boolean,snapshotType:{type:String,value:"full"},snapshots:{type:Array,value:[]},supervisorInfo:Object,installedAddons:{type:Array,computed:"_computeAddons(supervisorInfo)",observer:"_installedAddonsChanged"},addonList:Array,folderList:{type:Array,value:[{slug:"homeassistant",name:"Home Assistant configuration",checked:!0},{slug:"ssl",name:"SSL",checked:!0},{slug:"share",name:"Share",checked:!0},{slug:"addons/local",name:"Local add-ons",checked:!0}]},snapshotSlug:{type:String,notify:!0},snapshotDeleted:{type:Boolean,notify:!0,observer:"_snapshotDeletedChanged"},creatingSnapshot:Boolean,dialogOpened:Boolean,error:String}}}],(f=[{key:"ready",value:function(){var e=this;l(d(t.prototype),"ready",this).call(this),this.addEventListener("hass-api-called",function(t){return e._apiCalled(t)}),this._updateSnapshots()}},{key:"_apiCalled",value:function(e){e.detail.success&&this._updateSnapshots()}},{key:"_updateSnapshots",value:function(){var e=this;this.hass.callApi("get","hassio/snapshots").then(function(t){e.snapshots=t.data.snapshots},function(t){e.error=t.message})}},{key:"_createSnapshot",value:function(){var e=this;if(this.error="",!this.snapshotHasPassword||this.snapshotPassword.length){this.creatingSnapshot=!0;var t,n,o=this.snapshotName;if(o.length||(o=(new Date).toLocaleDateString(navigator.language,{weekday:"long",year:"numeric",month:"short",day:"numeric"})),"full"===this.snapshotType)t={name:o},n="hassio/snapshots/new/full";else{var a=this.addonList.filter(function(e){return e.checked}).map(function(e){return e.slug});t={name:o,folders:this.folderList.filter(function(e){return e.checked}).map(function(e){return e.slug}),addons:a},n="hassio/snapshots/new/partial"}this.snapshotHasPassword&&(t.password=this.snapshotPassword),this.hass.callApi("post",n,t).then(function(){e.creatingSnapshot=!1,e.fire("hass-api-called",{success:!0})},function(t){e.creatingSnapshot=!1,e.error=t.message})}else this.error="Please enter a password."}},{key:"_installedAddonsChanged",value:function(e){this.addonList=e.map(function(e){return{slug:e.slug,name:e.name,checked:!0}})}},{key:"_sortAddons",value:function(e,t){return e.name<t.name?-1:1}},{key:"_sortSnapshots",value:function(e,t){return e.date<t.date?1:-1}},{key:"_computeName",value:function(e){return e.name||e.slug}},{key:"_computeDetails",value:function(e){var t="full"===e.type?"Full snapshot":"Partial snapshot";return e.protected?"".concat(t,", password protected"):t}},{key:"_computeIcon",value:function(e){return"full"===e?"hassio:package-variant-closed":"hassio:package-variant"}},{key:"_snapshotClicked",value:function(e){var t,o,a=this;t=this,o={slug:e.model.snapshot.slug,onDelete:function(){return a._updateSnapshots()}},Object(r.a)(t,"show-dialog",{dialogTag:"dialog-hassio-snapshot",dialogImport:function(){return Promise.all([n.e(1),n.e(4)]).then(n.bind(null,135))},dialogParams:o}),this.snapshotSlug=e.model.snapshot.slug}},{key:"_fullSelected",value:function(e){return"full"===e}},{key:"refreshData",value:function(){var e=this;this.hass.callApi("post","hassio/snapshots/reload").then(function(){e._updateSnapshots()})}},{key:"_computeAddons",value:function(e){return e.addons}}])&&c(i.prototype,f),y&&c(i,y),t}();customElements.define("hassio-snapshots",f)},22:function(e,t,n){"use strict";var o=n(11),a=n(21);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}t.a=Object(o.a)(function(e){return function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),i(this,p(n).apply(this,arguments))}var o,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,e),o=n,(s=[{key:"fire",value:function(e,t,n){return n=n||{},Object(a.a)(n.node||this,e,t,n)}}])&&r(o.prototype,s),u&&r(o,u),n}()})}}]);