export const __rspack_esm_id="2136";export const __rspack_esm_ids=["2136"];export const __webpack_modules__={72487(t,e,i){i.a(t,async function(t,a){try{i.d(e,{Yq:()=>h,zB:()=>d});i(18111),i(20116);var o=i(74487),s=i(22786),r=i(46927),n=i(8480),l=t([o,n]);[o,n]=l.then?(await l)():l;(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:"long",month:"long",day:"numeric",timeZone:(0,n.w)(t.time_zone,e)}));const h=(t,e,i)=>c(e,i.time_zone).format(t),c=(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{year:"numeric",month:"long",day:"numeric",timeZone:(0,n.w)(t.time_zone,e)})),d=((0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{year:"numeric",month:"short",day:"numeric",timeZone:(0,n.w)(t.time_zone,e)})),(t,e,i)=>{const a=u(e,i.time_zone);if(e.date_format===r.ow.language||e.date_format===r.ow.system)return a.format(t);const o=a.formatToParts(t),s=o.find(t=>"literal"===t.type)?.value,n=o.find(t=>"day"===t.type)?.value,l=o.find(t=>"month"===t.type)?.value,h=o.find(t=>"year"===t.type)?.value,c=o[o.length-1];let d="literal"===c?.type?c?.value:"";"bg"===e.language&&e.date_format===r.ow.YMD&&(d="");return{[r.ow.DMY]:`${n}${s}${l}${s}${h}${d}`,[r.ow.MDY]:`${l}${s}${n}${s}${h}${d}`,[r.ow.YMD]:`${h}${s}${l}${s}${n}${d}`}[e.date_format]}),u=(0,s.A)((t,e)=>{const i=t.date_format===r.ow.system?void 0:t.language;return t.date_format===r.ow.language||(t.date_format,r.ow.system),new Intl.DateTimeFormat(i,{year:"numeric",month:"numeric",day:"numeric",timeZone:(0,n.w)(t.time_zone,e)})});(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{day:"numeric",month:"short",timeZone:(0,n.w)(t.time_zone,e)})),(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{month:"long",year:"numeric",timeZone:(0,n.w)(t.time_zone,e)})),(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{month:"long",timeZone:(0,n.w)(t.time_zone,e)})),(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{year:"numeric",timeZone:(0,n.w)(t.time_zone,e)})),(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:"long",timeZone:(0,n.w)(t.time_zone,e)})),(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:"short",timeZone:(0,n.w)(t.time_zone,e)}));a()}catch(t){a(t)}})},95747(t,e,i){i.a(t,async function(t,a){try{i.d(e,{r6:()=>d,yg:()=>m});var o=i(74487),s=i(22786),r=i(72487),n=i(30162),l=i(8480),h=i(69543),c=t([o,r,n,l]);[o,r,n,l]=c.then?(await c)():c;const d=(t,e,i)=>u(e,i.time_zone).format(t),u=(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{year:"numeric",month:"long",day:"numeric",hour:(0,h.J)(t)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,h.J)(t)?"h12":"h23",timeZone:(0,l.w)(t.time_zone,e)})),m=((0,s.A)(()=>new Intl.DateTimeFormat(void 0,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})),(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{year:"numeric",month:"short",day:"numeric",hour:(0,h.J)(t)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,h.J)(t)?"h12":"h23",timeZone:(0,l.w)(t.time_zone,e)})),(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{month:"short",day:"numeric",hour:(0,h.J)(t)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,h.J)(t)?"h12":"h23",timeZone:(0,l.w)(t.time_zone,e)})),(t,e,i)=>p(e,i.time_zone).format(t)),p=(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{year:"numeric",month:"long",day:"numeric",hour:(0,h.J)(t)?"numeric":"2-digit",minute:"2-digit",second:"2-digit",hourCycle:(0,h.J)(t)?"h12":"h23",timeZone:(0,l.w)(t.time_zone,e)}));a()}catch(t){a(t)}})},30162(t,e,i){i.a(t,async function(t,a){try{i.d(e,{LW:()=>g,Xs:()=>m,fU:()=>h,ie:()=>d});var o=i(74487),s=i(22786),r=i(8480),n=i(69543),l=t([o,r]);[o,r]=l.then?(await l)():l;const h=(t,e,i)=>c(e,i.time_zone).format(t),c=(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{hour:"numeric",minute:"2-digit",hourCycle:(0,n.J)(t)?"h12":"h23",timeZone:(0,r.w)(t.time_zone,e)})),d=(t,e,i)=>u(e,i.time_zone).format(t),u=(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{hour:(0,n.J)(t)?"numeric":"2-digit",minute:"2-digit",second:"2-digit",hourCycle:(0,n.J)(t)?"h12":"h23",timeZone:(0,r.w)(t.time_zone,e)})),m=(t,e,i)=>p(e,i.time_zone).format(t),p=(0,s.A)((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:"long",hour:(0,n.J)(t)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,n.J)(t)?"h12":"h23",timeZone:(0,r.w)(t.time_zone,e)})),g=(t,e,i)=>y(e,i.time_zone).format(t),y=(0,s.A)((t,e)=>new Intl.DateTimeFormat("en-GB",{hour:"numeric",minute:"2-digit",hour12:!1,timeZone:(0,r.w)(t.time_zone,e)}));a()}catch(t){a(t)}})},8480(t,e,i){i.a(t,async function(t,a){try{i.d(e,{w:()=>h});var o=i(74487),s=i(46927),r=t([o]);o=(r.then?(await r)():r)[0];const n=Intl.DateTimeFormat?.().resolvedOptions?.().timeZone,l=n??"UTC",h=(t,e)=>t===s.Wj.local&&n?l:e;a()}catch(t){a(t)}})},69543(t,e,i){i.d(e,{J:()=>s});var a=i(22786),o=i(46927);const s=(0,a.A)(t=>{if(t.time_format===o.Hg.language||t.time_format===o.Hg.system){const e=t.time_format===o.Hg.language?t.language:void 0;return new Date("January 1, 2023 22:00:00").toLocaleString(e).includes("10")}return t.time_format===o.Hg.am_pm})},80804(t,e,i){i.d(e,{H:()=>a});i(18111),i(61701);const a=async t=>{if(!t.parentNode)throw new Error("Cannot setup Leaflet map on disconnected element");const e=(await Promise.resolve().then(i.t.bind(i,78572,23))).default;e.Icon.Default.imagePath="/static/images/leaflet/images/",await i.e("3757").then(i.t.bind(i,17948,23));const a=e.map(t),s=document.createElement("link");s.setAttribute("href","/static/images/leaflet/leaflet.css"),s.setAttribute("rel","stylesheet"),t.parentNode.appendChild(s);const r=document.createElement("link");r.setAttribute("href","/static/images/leaflet/MarkerCluster.css"),r.setAttribute("rel","stylesheet"),t.parentNode.appendChild(r),a.setView([52.3731339,4.8903147],13);return[a,e,o(e).addTo(a)]},o=t=>t.tileLayer("https://basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}"+(t.Browser.retina?"@2x.png":".png"),{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>, &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",minZoom:0,maxZoom:20})},68246(t,e,i){i.d(e,{Y:()=>a});const a=t=>t.slice(t.indexOf(".")+1)},28978(t,e,i){i.d(e,{u:()=>o});var a=i(68246);const o=t=>{return e=t.entity_id,void 0===(i=t.attributes).friendly_name?(0,a.Y)(e).replace(/_/g," "):(i.friendly_name??"").toString();var e,i}},3894(t,e,i){i.d(e,{q:()=>o});var a=i(78572);class o extends a.Marker{onAdd(t){return super.onAdd(t),this.decorationLayer?.addTo(t),this}onRemove(t){return this.decorationLayer?.remove(),super.onRemove(t)}constructor(t,e,i){super(t,i),this.decorationLayer=e}}},75428(t,e,i){i.d(e,{D:()=>s});var a=i(75158),o=i.n(a);const s=t=>o()(t,{whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:!0})},3449(t,e,i){var a=i(62826),o=i(96196),s=i(77845);class r extends o.WF{render(){return o.qy`<slot></slot>`}constructor(...t){super(...t),this.disabled=!1}}r.styles=o.AH`:host{display:block;color:var(--mdc-text-field-label-ink-color,rgba(0,0,0,.6));font-size:.75rem;padding-left:16px;padding-right:16px;padding-inline-start:16px;padding-inline-end:16px;letter-spacing:var(
        --mdc-typography-caption-letter-spacing,
        .0333333333em
      );line-height:normal}:host([disabled]){color:var(--mdc-text-field-disabled-ink-color,rgba(0,0,0,.6))}`,(0,a.Cg)([(0,s.MZ)({type:Boolean,reflect:!0})],r.prototype,"disabled",void 0),r=(0,a.Cg)([(0,s.EM)("ha-input-helper-text")],r)},21160(t,e,i){i.a(t,async function(t,a){try{i.r(e),i.d(e,{HaLocationSelector:()=>d});var o=i(62826),s=i(96196),r=i(77845),n=i(22786),l=i(1087),h=i(99257),c=(i(52763),t([h]));h=(c.then?(await c)():c)[0];class d extends s.WF{willUpdate(){this.value||(this.value={latitude:this.hass.config.latitude,longitude:this.hass.config.longitude,radius:this.selector.location?.radius?1e3:void 0})}render(){return s.qy` <p>${this.label?this.label:""}</p> <ha-locations-editor class="flex" .hass="${this.hass}" .helper="${this.helper}" .locations="${this._location(this.selector,this.value)}" @location-updated="${this._locationChanged}" @radius-updated="${this._radiusChanged}" pin-on-click></ha-locations-editor> <ha-form .hass="${this.hass}" .schema="${this._schema(this.hass.localize,this.selector.location?.radius,this.selector.location?.radius_readonly)}" .data="${this.value}" .computeLabel="${this._computeLabel}" .disabled="${this.disabled}" @value-changed="${this._valueChanged}"></ha-form> `}_locationChanged(t){const[e,i]=t.detail.location;(0,l.r)(this,"value-changed",{value:{...this.value,latitude:e,longitude:i}})}_radiusChanged(t){const e=Math.round(t.detail.radius);(0,l.r)(this,"value-changed",{value:{...this.value,radius:e}})}_valueChanged(t){t.stopPropagation();const e=t.detail.value,i=Math.round(t.detail.value.radius);(0,l.r)(this,"value-changed",{value:{latitude:e.latitude,longitude:e.longitude,...this.selector.location?.radius&&!this.selector.location?.radius_readonly?{radius:i}:{}}})}constructor(...t){super(...t),this.disabled=!1,this._schema=(0,n.A)((t,e,i)=>[{name:"",type:"grid",schema:[{name:"latitude",required:!0,selector:{number:{step:"any",unit_of_measurement:"°"}}},{name:"longitude",required:!0,selector:{number:{step:"any",unit_of_measurement:"°"}}}]},...e?[{name:"radius",required:!0,default:1e3,disabled:!!i,selector:{number:{min:0,step:1,mode:"box",unit_of_measurement:t("ui.components.selectors.location.radius_meters")}}}]:[]]),this._location=(0,n.A)((t,e)=>{const i=getComputedStyle(this),a=t.location?.radius?i.getPropertyValue("--zone-radius-color")||i.getPropertyValue("--accent-color"):void 0;return[{id:"location",latitude:!e||isNaN(e.latitude)?this.hass.config.latitude:e.latitude,longitude:!e||isNaN(e.longitude)?this.hass.config.longitude:e.longitude,radius:t.location?.radius?e?.radius||1e3:void 0,radius_color:a,icon:t.location?.icon||t.location?.radius?"mdi:map-marker-radius":"mdi:map-marker",location_editable:!0,radius_editable:!!t.location?.radius&&!t.location?.radius_readonly}]}),this._computeLabel=t=>t.name?this.hass.localize(`ui.components.selectors.location.${t.name}`):""}}d.styles=s.AH`ha-locations-editor{display:block;height:400px;margin-bottom:16px}p{margin-top:0}`,(0,o.Cg)([(0,r.MZ)({attribute:!1})],d.prototype,"hass",void 0),(0,o.Cg)([(0,r.MZ)({attribute:!1})],d.prototype,"selector",void 0),(0,o.Cg)([(0,r.MZ)({type:Object})],d.prototype,"value",void 0),(0,o.Cg)([(0,r.MZ)()],d.prototype,"label",void 0),(0,o.Cg)([(0,r.MZ)()],d.prototype,"helper",void 0),(0,o.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],d.prototype,"disabled",void 0),d=(0,o.Cg)([(0,r.EM)("ha-selector-location")],d),a()}catch(t){a(t)}})},93367(t,e,i){i.a(t,async function(t,e){try{var a=i(62826),o=i(96196),s=i(77845),r=i(3890),n=i(69093),l=i(85694),h=(i(67094),t([l]));l=(h.then?(await h)():h)[0];class c extends o.WF{render(){const t=this.icon||this.stateObj&&this.hass?.entities[this.stateObj.entity_id]?.icon||this.stateObj?.attributes.icon;if(t)return o.qy`<ha-icon .icon="${t}"></ha-icon>`;if(!this.stateObj)return o.s6;if(!this.hass)return this._renderFallback();const e=(0,l.fq)(this.hass,this.stateObj,this.stateValue).then(t=>t?o.qy`<ha-icon .icon="${t}"></ha-icon>`:this._renderFallback());return o.qy`${(0,r.T)(e)}`}_renderFallback(){const t=(0,n.t)(this.stateObj);return o.qy` <ha-svg-icon .path="${l.l[t]||l.lW}"></ha-svg-icon> `}}(0,a.Cg)([(0,s.MZ)({attribute:!1})],c.prototype,"hass",void 0),(0,a.Cg)([(0,s.MZ)({attribute:!1})],c.prototype,"stateObj",void 0),(0,a.Cg)([(0,s.MZ)({attribute:!1})],c.prototype,"stateValue",void 0),(0,a.Cg)([(0,s.MZ)()],c.prototype,"icon",void 0),c=(0,a.Cg)([(0,s.EM)("ha-state-icon")],c),e()}catch(t){e(t)}})},30219(t,e,i){i.a(t,async function(t,e){try{var a=i(62826),o=i(96196),s=i(77845),r=i(29485),n=i(1087),l=i(93367),h=t([l]);l=(h.then?(await h)():h)[0];class c extends o.WF{render(){return o.qy` <div class="marker ${this.entityPicture?"picture":""}" style="${(0,r.W)({"border-color":this.entityColor})}" @click="${this._badgeTap}"> ${this.entityPicture?o.qy`<div class="entity-picture" style="${(0,r.W)({"background-image":`url(${this.entityPicture})`})}"></div>`:this.showIcon&&this.entityId?o.qy`<ha-state-icon .hass="${this.hass}" .stateObj="${this.hass?.states[this.entityId]}"></ha-state-icon>`:this.entityUnit?o.qy` ${this.entityName} <span class="unit" style="display:${this.entityUnit?"initial":"none"}">${this.entityUnit}</span> `:this.entityName} </div> `}_badgeTap(t){t.stopPropagation(),this.entityId&&(0,n.r)(this,"hass-more-info",{entityId:this.entityId})}constructor(...t){super(...t),this.showIcon=!1}}c.styles=o.AH`.marker{display:flex;justify-content:center;text-align:center;align-items:center;box-sizing:border-box;width:var(--ha-marker-size,48px);height:var(--ha-marker-size,48px);font-size:var(--ha-marker-font-size, var(--ha-font-size-xl));border-radius:var(--ha-marker-border-radius,50%);border:1px solid var(--ha-marker-color,var(--primary-color));color:var(--primary-text-color);background-color:var(--card-background-color)}.marker.picture{overflow:hidden}.entity-picture{background-size:cover;height:100%;width:100%}.unit{margin-left:2px}`,(0,a.Cg)([(0,s.MZ)({attribute:!1})],c.prototype,"hass",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"entity-id",reflect:!0})],c.prototype,"entityId",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"entity-name"})],c.prototype,"entityName",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"entity-unit"})],c.prototype,"entityUnit",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"entity-picture"})],c.prototype,"entityPicture",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"entity-color"})],c.prototype,"entityColor",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"show-icon",type:Boolean})],c.prototype,"showIcon",void 0),c=(0,a.Cg)([(0,s.EM)("ha-entity-marker")],c),e()}catch(t){e(t)}})},99257(t,e,i){i.a(t,async function(t,e){try{i(44114),i(18111),i(22489),i(7588),i(61701);var a=i(62826),o=i(96196),s=i(77845),r=i(22786),n=i(1087),l=(i(3449),i(22273)),h=t([l]);l=(h.then?(await h)():h)[0];class c extends o.WF{fitMap(t){this.map.fitMap(t)}fitBounds(t,e){this.map.fitBounds(t,e)}async fitMarker(t,e){if(this.Leaflet||await this._loadPromise,!this.map.leafletMap||!this._locationMarkers)return;const i=this._locationMarkers[t];if(i)if("getBounds"in i)this.map.leafletMap.fitBounds(i.getBounds()),i.bringToFront();else{const a=this._circles[t];a?this.map.leafletMap.fitBounds(a.getBounds()):this.map.leafletMap.setView(i.getLatLng(),e?.zoom||this.zoom)}}render(){return o.qy` <ha-map .hass="${this.hass}" .layers="${this._getLayers(this._circles,this._locationMarkers)}" .zoom="${this.zoom}" .autoFit="${this.autoFit}" .themeMode="${this.themeMode}" .clickable="${this.pinOnClick}" @map-clicked="${this._mapClicked}"></ha-map> ${this.helper?o.qy`<ha-input-helper-text>${this.helper}</ha-input-helper-text>`:""} `}willUpdate(t){super.willUpdate(t),this.Leaflet&&t.has("locations")&&this._updateMarkers()}updated(t){if(this.Leaflet&&t.has("locations")){const e=t.get("locations"),i=this.locations?.filter((t,i)=>!e[i]||(t.latitude!==e[i].latitude||t.longitude!==e[i].longitude)&&this.map.leafletMap?.getBounds().contains({lat:e[i].latitude,lng:e[i].longitude})&&!this.map.leafletMap?.getBounds().contains({lat:t.latitude,lng:t.longitude}));1===i?.length&&this.map.leafletMap?.panTo({lat:i[0].latitude,lng:i[0].longitude})}}_normalizeLongitude(t){return Math.abs(t)>180?(t%360+540)%360-180:t}_updateLocation(t){const e=t.target,i=e.getLatLng(),a=[i.lat,this._normalizeLongitude(i.lng)];(0,n.r)(this,"location-updated",{id:e.id,location:a},{bubbles:!1})}_updateRadius(t){const e=t.target,i=this._locationMarkers[e.id];(0,n.r)(this,"radius-updated",{id:e.id,radius:i.getRadius()},{bubbles:!1})}_markerClicked(t){const e=t.target;(0,n.r)(this,"marker-clicked",{id:e.id},{bubbles:!1})}_mapClicked(t){if(this.pinOnClick&&this._locationMarkers){const e=Object.keys(this._locationMarkers)[0],i=[t.detail.location[0],this._normalizeLongitude(t.detail.location[1])];(0,n.r)(this,"location-updated",{id:e,location:i},{bubbles:!1}),i[1]!==t.detail.location[1]&&this.map.leafletMap?.panTo({lat:i[0],lng:i[1]})}}_updateMarkers(){if(!this.locations||!this.locations.length)return this._circles={},void(this._locationMarkers=void 0);const t={},e={},i=getComputedStyle(this).getPropertyValue("--accent-color");this.locations.forEach(a=>{let o;if(a.icon||a.iconPath){const t=document.createElement("div");let e;t.className="named-icon",void 0!==a.name&&(t.innerText=a.name),a.icon?(e=document.createElement("ha-icon"),e.setAttribute("icon",a.icon)):(e=document.createElement("ha-svg-icon"),e.setAttribute("path",a.iconPath)),t.prepend(e),o=this.Leaflet.divIcon({html:t.outerHTML,iconSize:[24,24],className:"light"})}if(a.radius){const s=this.Leaflet.circle([a.latitude,a.longitude],{color:a.radius_color||i,radius:a.radius});a.radius_editable||a.location_editable?(s.editing.enable(),s.addEventListener("add",()=>{const t=s.editing._moveMarker,e=s.editing._resizeMarkers[0];o&&t.setIcon(o),e.id=t.id=a.id,t.addEventListener("dragend",t=>this._updateLocation(t)).addEventListener("click",t=>this._markerClicked(t)),a.radius_editable?e.addEventListener("dragend",t=>this._updateRadius(t)):e.remove()}),t[a.id]=s):e[a.id]=s}if(!a.radius||!a.radius_editable&&!a.location_editable){const e={title:a.name,draggable:a.location_editable};o&&(e.icon=o);const i=this.Leaflet.marker([a.latitude,a.longitude],e).addEventListener("dragend",t=>this._updateLocation(t)).addEventListener("click",t=>this._markerClicked(t));i.id=a.id,t[a.id]=i}}),this._circles=e,this._locationMarkers=t,(0,n.r)(this,"markers-updated")}constructor(){super(),this.autoFit=!1,this.zoom=16,this.themeMode="auto",this.pinOnClick=!1,this._circles={},this._getLayers=(0,r.A)((t,e)=>{const i=[];return Array.prototype.push.apply(i,Object.values(t)),e&&Array.prototype.push.apply(i,Object.values(e)),i}),this._loadPromise=Promise.resolve().then(i.t.bind(i,78572,23)).then(t=>i.e("9293").then(i.t.bind(i,60108,23)).then(()=>(this.Leaflet=t.default,this._updateMarkers(),this.updateComplete.then(()=>this.fitMap()))))}}c.styles=o.AH`ha-map{display:block;height:100%}`,(0,a.Cg)([(0,s.MZ)({attribute:!1})],c.prototype,"hass",void 0),(0,a.Cg)([(0,s.MZ)({attribute:!1})],c.prototype,"locations",void 0),(0,a.Cg)([(0,s.MZ)()],c.prototype,"helper",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"auto-fit",type:Boolean})],c.prototype,"autoFit",void 0),(0,a.Cg)([(0,s.MZ)({type:Number})],c.prototype,"zoom",void 0),(0,a.Cg)([(0,s.MZ)({attribute:"theme-mode",type:String})],c.prototype,"themeMode",void 0),(0,a.Cg)([(0,s.MZ)({type:Boolean,attribute:"pin-on-click"})],c.prototype,"pinOnClick",void 0),(0,a.Cg)([(0,s.wk)()],c.prototype,"_locationMarkers",void 0),(0,a.Cg)([(0,s.wk)()],c.prototype,"_circles",void 0),(0,a.Cg)([(0,s.P)("ha-map",!0)],c.prototype,"map",void 0),c=(0,a.Cg)([(0,s.EM)("ha-locations-editor")],c),e()}catch(t){e(t)}})},22273(t,e,i){i.a(t,async function(t,e){try{i(44114),i(18111),i(7588),i(61701);var a=i(62826),o=i(34909),s=i(96196),r=i(77845),n=i(95747),l=i(30162),h=i(1087),c=i(80804),d=i(69093),u=i(28978),m=i(3894),p=i(75428),g=i(88438),y=(i(50888),i(30219)),f=t([y,n,l]);[y,n,l]=f.then?(await f)():f;const _=250,v=t=>"string"==typeof t?t:t.entity_id;class b extends s.mN{connectedCallback(){this._pauseAutoFit=!1,document.addEventListener("visibilitychange",this._handleVisibilityChange),this._handleVisibilityChange(),super.connectedCallback(),this._loadMap(),this._attachObserver()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("visibilitychange",this._handleVisibilityChange),this.leafletMap&&(this.leafletMap.remove(),this.leafletMap=void 0,this.Leaflet=void 0),this._loaded=!1,this._resizeObserver&&this._resizeObserver.unobserve(this)}update(t){if(super.update(t),!this._loaded)return;let e=!1;const i=t.get("hass");if(t.has("_loaded")||t.has("entities"))this._drawEntities(),e=!this._pauseAutoFit;else if(this._loaded&&i&&this.entities)for(const t of this.entities)if(i.states[v(t)]!==this.hass.states[v(t)]){this._drawEntities(),e=!this._pauseAutoFit;break}t.has("clusterMarkers")&&this._drawEntities(),(t.has("_loaded")||t.has("paths"))&&this._drawPaths(),(t.has("_loaded")||t.has("layers"))&&(this._drawLayers(t.get("layers")),e=!0),(t.has("_loaded")||this.autoFit&&e)&&this.fitMap(),t.has("zoom")&&(this._isProgrammaticFit=!0,this.leafletMap.setZoom(this.zoom),setTimeout(()=>{this._isProgrammaticFit=!1},_)),(t.has("themeMode")||t.has("hass")&&(!i||i.themes?.darkMode!==this.hass.themes?.darkMode))&&this._updateMapStyle()}get _darkMode(){return"dark"===this.themeMode||"auto"===this.themeMode&&Boolean(this.hass.themes.darkMode)}_updateMapStyle(){const t=this.renderRoot.querySelector("#map");t.classList.toggle("clickable",this.clickable),t.classList.toggle("dark",this._darkMode),t.classList.toggle("forced-dark","dark"===this.themeMode),t.classList.toggle("forced-light","light"===this.themeMode)}async _loadMap(){if(this._loading)return;let t=this.shadowRoot.getElementById("map");t||(t=document.createElement("div"),t.id="map",this.shadowRoot.append(t)),this._loading=!0;try{[this.leafletMap,this.Leaflet]=await(0,c.H)(t),this._updateMapStyle(),this.leafletMap.on("click",t=>{0===this._clickCount&&setTimeout(()=>{1===this._clickCount&&(0,h.r)(this,"map-clicked",{location:[t.latlng.lat,t.latlng.lng]}),this._clickCount=0},250),this._clickCount++}),this.leafletMap.on("zoomstart",()=>{this._isProgrammaticFit||(this._pauseAutoFit=!0)}),this.leafletMap.on("movestart",()=>{this._isProgrammaticFit||(this._pauseAutoFit=!0)}),this._loaded=!0}finally{this._loading=!1}}fitMap(t){if(t?.unpause_autofit&&(this._pauseAutoFit=!1),!this.leafletMap||!this.Leaflet||!this.hass)return;if(!this._mapFocusItems.length&&!this._mapFocusZones.length&&!this.layers?.length)return this._isProgrammaticFit=!0,this.leafletMap.setView(new this.Leaflet.LatLng(this.hass.config.latitude,this.hass.config.longitude),t?.zoom||this.zoom),void setTimeout(()=>{this._isProgrammaticFit=!1},_);let e=this.Leaflet.latLngBounds(this._mapFocusItems?this._mapFocusItems.map(t=>t.getLatLng()):[]);this._mapFocusZones?.forEach(t=>{e.extend("getBounds"in t?t.getBounds():t.getLatLng())}),this.layers?.forEach(t=>{e.extend("getBounds"in t?t.getBounds():t.getLatLng())}),e=e.pad(t?.pad??.5),this._isProgrammaticFit=!0,this.leafletMap.fitBounds(e,{maxZoom:t?.zoom||this.zoom}),setTimeout(()=>{this._isProgrammaticFit=!1},_)}fitBounds(t,e){if(!this.leafletMap||!this.Leaflet||!this.hass)return;const i=this.Leaflet.latLngBounds(t).pad(e?.pad??.5);this._isProgrammaticFit=!0,this.leafletMap.fitBounds(i,{maxZoom:e?.zoom||this.zoom}),setTimeout(()=>{this._isProgrammaticFit=!1},_)}_drawLayers(t){if(t&&t.forEach(t=>t.remove()),!this.layers)return;const e=this.leafletMap;this.layers.forEach(t=>{e.addLayer(t)})}_computePathTooltip(t,e){let i;return i=t.fullDatetime?(0,n.r6)(e.timestamp,this.hass.locale,this.hass.config):(0,o.c)(e.timestamp)?(0,l.ie)(e.timestamp,this.hass.locale,this.hass.config):(0,l.Xs)(e.timestamp,this.hass.locale,this.hass.config),`${(0,p.D)(t.name??"")}<br>${i}`}_drawPaths(){const t=this.hass,e=this.leafletMap,i=this.Leaflet;if(!t||!e||!i)return;if(this._mapPaths.length&&(this._mapPaths.forEach(t=>t.remove()),this._mapPaths=[]),!this.paths)return;const a=getComputedStyle(this).getPropertyValue("--dark-primary-color");this.paths.forEach(t=>{let o,s;t.gradualOpacity&&(o=t.gradualOpacity/(t.points.length-2),s=1-t.gradualOpacity);for(let e=0;e<t.points.length-1;e++){const r=t.gradualOpacity?s+e*o:void 0;this._mapPaths.push(i.circleMarker(t.points[e].point,{radius:g.C?8:3,color:t.color||a,opacity:r,fillOpacity:r,interactive:!0}).bindTooltip(this._computePathTooltip(t,t.points[e]),{direction:"top"})),this._mapPaths.push(i.polyline([t.points[e].point,t.points[e+1].point],{color:t.color||a,opacity:r,interactive:!1}))}const r=t.points.length-1;if(r>=0){const e=t.gradualOpacity?s+r*o:void 0;this._mapPaths.push(i.circleMarker(t.points[r].point,{radius:g.C?8:3,color:t.color||a,opacity:e,fillOpacity:e,interactive:!0}).bindTooltip(this._computePathTooltip(t,t.points[r]),{direction:"top"}))}this._mapPaths.forEach(t=>e.addLayer(t))})}_drawEntities(){const t=this.hass,e=this.leafletMap,i=this.Leaflet;if(!t||!e||!i)return;if(this._mapItems.length&&(this._mapItems.forEach(t=>t.remove()),this._mapItems=[],this._mapFocusItems=[]),this._mapZones.length&&(this._mapZones.forEach(t=>t.remove()),this._mapZones=[],this._mapFocusZones=[]),this._mapCluster&&(this._mapCluster.remove(),this._mapCluster=void 0),!this.entities)return;const a=getComputedStyle(this),o=a.getPropertyValue("--accent-color"),s=a.getPropertyValue("--secondary-text-color"),r=a.getPropertyValue("--dark-primary-color"),n=this._darkMode?"dark":"light";for(const e of this.entities){const l=t.states[v(e)];if(!l)continue;const h="string"!=typeof e?e.name:void 0,c=h??(0,u.u)(l),{latitude:p,longitude:g,passive:y,icon:f,radius:_,entity_picture:b,gps_accuracy:k}=l.attributes;if(!p||!g)continue;if("zone"===(0,d.t)(l)){if(y&&!this.renderPassive)continue;let t="";if(f){const e=document.createElement("ha-icon");e.setAttribute("icon",f),t=e.outerHTML}else{const e=document.createElement("span");e.textContent=c,t=e.outerHTML}const r=i.circle([p,g],{interactive:!1,color:y?s:o,radius:_}),l=this._getMarkerSize(a)/2,h=new m.q([p,g],r,{icon:i.divIcon({html:t,iconSize:[l,l],className:n}),interactive:this.interactiveZones,title:c});this._mapZones.push(h),!this.fitZones||"string"!=typeof e&&!1===e.focus||this._mapFocusZones.push(r);continue}const M="string"!=typeof e&&"state"===e.label_mode?this.hass.formatEntityState(l):"string"!=typeof e&&"attribute"===e.label_mode&&void 0!==e.attribute?this.hass.formatEntityAttributeValue(l,e.attribute):h??c.split(" ").map(t=>t[0]).join("").substr(0,3),w=document.createElement("ha-entity-marker");w.hass=this.hass,w.showIcon="string"!=typeof e&&"icon"===e.label_mode,w.entityId=v(e),w.entityName=M,w.entityUnit="string"!=typeof e&&e.unit&&"attribute"===e.label_mode?e.unit:"",w.entityPicture=!b||"string"!=typeof e&&e.label_mode?"":this.hass.hassUrl(b),"string"!=typeof e&&(w.entityColor=e.color);const C=this._getMarkerSize(a),z=new m.q([p,g],void 0,{icon:i.divIcon({html:w,iconSize:[C,C],className:""}),title:c});"string"!=typeof e&&!1===e.focus||this._mapFocusItems.push(z),k&&(z.decorationLayer=i.circle([p,g],{interactive:!1,color:r,radius:k})),this._mapItems.push(z)}this.clusterMarkers?(this._mapCluster=i.markerClusterGroup({showCoverageOnHover:!1,removeOutsideVisibleBounds:!1,maxClusterRadius:40}),this._mapCluster.addLayers(this._mapItems),e.addLayer(this._mapCluster)):this._mapItems.forEach(t=>e.addLayer(t)),this._mapZones.forEach(t=>e.addLayer(t))}_getMarkerSize(t){const e=t.getPropertyValue("--ha-marker-size"),i=parseFloat(e);return Number.isNaN(i)?48:i}async _attachObserver(){this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{this.leafletMap?.invalidateSize({debounceMoveend:!0})})),this._resizeObserver.observe(this)}constructor(...t){super(...t),this.clickable=!1,this.autoFit=!1,this.renderPassive=!1,this.interactiveZones=!1,this.fitZones=!1,this.themeMode="auto",this.zoom=14,this.clusterMarkers=!0,this._loaded=!1,this._mapItems=[],this._mapFocusItems=[],this._mapZones=[],this._mapFocusZones=[],this._mapPaths=[],this._clickCount=0,this._isProgrammaticFit=!1,this._pauseAutoFit=!1,this._handleVisibilityChange=async()=>{document.hidden||setTimeout(()=>{this._pauseAutoFit=!1},500)},this._loading=!1}}b.styles=s.AH`:host{display:block;height:300px}#map{height:100%}#map.clickable{cursor:pointer}#map.dark{background:#090909}#map.forced-dark{color:#fff;--map-filter:invert(0.9) hue-rotate(170deg) brightness(1.5) contrast(1.2) saturate(0.3)}#map.forced-light{background:#fff;color:#000;--map-filter:invert(0)}#map.clickable:active,#map:active{cursor:grabbing;cursor:-moz-grabbing;cursor:-webkit-grabbing}.leaflet-tile-pane{filter:var(--map-filter)}.dark .leaflet-bar a{background-color:#1c1c1c;color:#fff}.dark .leaflet-bar a:hover{background-color:#313131}.leaflet-marker-draggable{cursor:move!important}.leaflet-edit-resize{border-radius:var(--ha-border-radius-circle);cursor:nesw-resize!important}.named-icon{display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;color:var(--primary-text-color)}.leaflet-pane{z-index:0!important}.leaflet-bottom,.leaflet-control,.leaflet-top{z-index:1!important}.leaflet-tooltip{padding:8px;font-size:var(--ha-font-size-s);background:rgba(80,80,80,.9)!important;color:#fff!important;border-radius:var(--ha-border-radius-sm);box-shadow:none!important;text-align:center}ha-icon{--mdc-icon-size:calc(var(--ha-marker-size, 48px) / 2)}.marker-cluster div{background-clip:padding-box;background-color:var(--primary-color);border:3px solid rgba(var(--rgb-primary-color),.2);width:calc(var(--ha-marker-size,48px) * .667);height:calc(var(--ha-marker-size,48px) * .667);border-radius:50%;text-align:center;align-content:center;color:var(--text-primary-color);font-size:var(--ha-font-size-m)}.marker-cluster span{line-height:var(--ha-line-height-expanded)}`,(0,a.Cg)([(0,r.MZ)({attribute:!1})],b.prototype,"hass",void 0),(0,a.Cg)([(0,r.MZ)({attribute:!1})],b.prototype,"entities",void 0),(0,a.Cg)([(0,r.MZ)({attribute:!1})],b.prototype,"paths",void 0),(0,a.Cg)([(0,r.MZ)({attribute:!1})],b.prototype,"layers",void 0),(0,a.Cg)([(0,r.MZ)({type:Boolean})],b.prototype,"clickable",void 0),(0,a.Cg)([(0,r.MZ)({attribute:"auto-fit",type:Boolean})],b.prototype,"autoFit",void 0),(0,a.Cg)([(0,r.MZ)({attribute:"render-passive",type:Boolean})],b.prototype,"renderPassive",void 0),(0,a.Cg)([(0,r.MZ)({attribute:"interactive-zones",type:Boolean})],b.prototype,"interactiveZones",void 0),(0,a.Cg)([(0,r.MZ)({attribute:"fit-zones",type:Boolean})],b.prototype,"fitZones",void 0),(0,a.Cg)([(0,r.MZ)({attribute:"theme-mode",type:String})],b.prototype,"themeMode",void 0),(0,a.Cg)([(0,r.MZ)({type:Number})],b.prototype,"zoom",void 0),(0,a.Cg)([(0,r.MZ)({attribute:"cluster-markers",type:Boolean})],b.prototype,"clusterMarkers",void 0),(0,a.Cg)([(0,r.wk)()],b.prototype,"_loaded",void 0),b=(0,a.Cg)([(0,r.EM)("ha-map")],b),e()}catch(t){e(t)}})},88438(t,e,i){i.d(e,{C:()=>a});const a="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}};
//# sourceMappingURL=2136.53b45b38d09754e0.js.map