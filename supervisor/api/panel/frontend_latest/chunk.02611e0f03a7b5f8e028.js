(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[690],{8494:(t,i,s)=>{"use strict";let e;async function h(){return e||async function(){e=window.EventTarget;try{new e}catch(t){e=(await s.e(251).then(s.t.bind(s,8251,23))).default.EventTarget}return e}()}s.r(i),s.d(i,{Layout1d:()=>_});class _ extends class{constructor(t){this._latestCoords={left:0,top:0},this._direction="vertical",this._viewportSize={width:0,height:0},this._pendingReflow=!1,this._scrollToIndex=-1,this._scrollToAnchor=0,this._eventTargetPromise=h().then((t=>this._eventTarget=new t)),this._physicalMin=0,this._physicalMax=0,this._first=-1,this._last=-1,this._itemSize={width:100,height:100},this._spacing=0,this._sizeDim="height",this._secondarySizeDim="width",this._positionDim="top",this._secondaryPositionDim="left",this._scrollPosition=0,this._scrollError=0,this._totalItems=0,this._scrollSize=1,this._overhang=150,Object.assign(this,t)}get totalItems(){return this._totalItems}set totalItems(t){t!==this._totalItems&&(this._totalItems=t,this._scheduleReflow())}get direction(){return this._direction}set direction(t){(t="horizontal"===t?t:"vertical")!==this._direction&&(this._direction=t,this._sizeDim="horizontal"===t?"width":"height",this._secondarySizeDim="horizontal"===t?"height":"width",this._positionDim="horizontal"===t?"left":"top",this._secondaryPositionDim="horizontal"===t?"top":"left",this._scheduleReflow())}get itemSize(){return this._itemSize}set itemSize(t){const{_itemDim1:i,_itemDim2:s}=this;Object.assign(this._itemSize,t),i===this._itemDim1&&s===this._itemDim2||(s!==this._itemDim2?this._itemDim2Changed():this._scheduleReflow())}get spacing(){return this._spacing}set spacing(t){t!==this._spacing&&(this._spacing=t,this._scheduleReflow())}get viewportSize(){return this._viewportSize}set viewportSize(t){const{_viewDim1:i,_viewDim2:s}=this;Object.assign(this._viewportSize,t),s!==this._viewDim2?this._viewDim2Changed():i!==this._viewDim1&&this._checkThresholds()}get viewportScroll(){return this._latestCoords}set viewportScroll(t){Object.assign(this._latestCoords,t);const i=this._scrollPosition;this._scrollPosition=this._latestCoords[this._positionDim],i!==this._scrollPosition&&(this._scrollPositionChanged(i,this._scrollPosition),this._updateVisibleIndices()),this._checkThresholds()}reflowIfNeeded(){this._pendingReflow&&(this._pendingReflow=!1,this._reflow())}scrollToIndex(t,i="start"){if(Number.isFinite(t)){switch(t=Math.min(this.totalItems,Math.max(0,t)),this._scrollToIndex=t,"nearest"===i&&(i=t>this._first+this._num/2?"end":"start"),i){case"start":this._scrollToAnchor=0;break;case"center":this._scrollToAnchor=.5;break;case"end":this._scrollToAnchor=1;break;default:throw new TypeError("position must be one of: start, center, end, nearest")}this._scheduleReflow(),this.reflowIfNeeded()}}async dispatchEvent(...t){await this._eventTargetPromise,this._eventTarget.dispatchEvent(...t)}async addEventListener(...t){await this._eventTargetPromise,this._eventTarget.addEventListener(...t)}async removeEventListener(...t){await this._eventTargetPromise,this._eventTarget.removeEventListener(...t)}updateItemSizes(t){}_itemDim2Changed(){}_viewDim2Changed(){}_getItemSize(t){return{[this._sizeDim]:this._itemDim1,[this._secondarySizeDim]:this._itemDim2}}get _delta(){return this._itemDim1+this._spacing}get _itemDim1(){return this._itemSize[this._sizeDim]}get _itemDim2(){return this._itemSize[this._secondarySizeDim]}get _viewDim1(){return this._viewportSize[this._sizeDim]}get _viewDim2(){return this._viewportSize[this._secondarySizeDim]}_scheduleReflow(){this._pendingReflow=!0}_reflow(){const{_first:t,_last:i,_scrollSize:s}=this;this._updateScrollSize(),this._getActiveItems(),this._scrollIfNeeded(),this._scrollSize!==s&&this._emitScrollSize(),-1===this._first&&-1===this._last?this._emitRange():(this._first!==t||this._last!==i||this._spacingChanged)&&(this._emitRange(),this._emitChildPositions()),this._emitScrollError()}_updateScrollSize(){this._scrollSize=Math.max(1,this._totalItems*this._delta)}_scrollIfNeeded(){if(-1===this._scrollToIndex)return;const t=this._scrollToIndex,i=this._scrollToAnchor,s=this._getItemPosition(t)[this._positionDim],e=this._getItemSize(t)[this._sizeDim],h=this._scrollPosition+this._viewDim1*i,_=s+e*i,o=Math.floor(Math.min(this._scrollSize-this._viewDim1,Math.max(0,this._scrollPosition-h+_)));this._scrollError+=this._scrollPosition-o,this._scrollPosition=o}_emitRange(t){const i=Object.assign({first:this._first,last:this._last,num:this._num,stable:!0,firstVisible:this._firstVisible,lastVisible:this._lastVisible},t);this.dispatchEvent(new CustomEvent("rangechange",{detail:i}))}_emitScrollSize(){const t={[this._sizeDim]:this._scrollSize};this.dispatchEvent(new CustomEvent("scrollsizechange",{detail:t}))}_emitScrollError(){if(this._scrollError){const t={[this._positionDim]:this._scrollError,[this._secondaryPositionDim]:0};this.dispatchEvent(new CustomEvent("scrollerrorchange",{detail:t})),this._scrollError=0}}_emitChildPositions(){const t={};for(let i=this._first;i<=this._last;i++)t[i]=this._getItemPosition(i);this.dispatchEvent(new CustomEvent("itempositionchange",{detail:t}))}get _num(){return-1===this._first||-1===this._last?0:this._last-this._first+1}_checkThresholds(){if(0===this._viewDim1&&this._num>0)this._scheduleReflow();else{const t=Math.max(0,this._scrollPosition-this._overhang),i=Math.min(this._scrollSize,this._scrollPosition+this._viewDim1+this._overhang);(this._physicalMin>t||this._physicalMax<i)&&this._scheduleReflow()}}_updateVisibleIndices(){let t=this._firstVisible,i=this._lastVisible;for(let s=this._first;s<=this._last;s++){const e=this._getItemPosition(s)[this._positionDim];e<=this._scrollPosition&&(t=s),e<this._scrollPosition+this._viewDim1&&(i=s)}t>i||t===this._firstVisible&&i===this._lastVisible||(this._firstVisible=t,this._lastVisible=i,this._emitRange())}_scrollPositionChanged(t,i){const s=this._scrollSize-this._viewDim1;(t<s||i<s)&&(this._scrollToIndex=-1)}}{constructor(t){super(t),this._physicalItems=new Map,this._newPhysicalItems=new Map,this._metrics=new Map,this._anchorIdx=null,this._anchorPos=null,this._stable=!0,this._needsRemeasure=!1,this._nMeasured=0,this._tMeasured=0,this._estimate=!0}updateItemSizes(t){Object.keys(t).forEach((i=>{const s=t[i],e=this._getMetrics(Number(i)),h=e[this._sizeDim];e.width=s.width+(s.marginLeft||0)+(s.marginRight||0),e.height=s.height+(s.marginTop||0)+(s.marginBottom||0);const _=e[this._sizeDim],o=this._getPhysicalItem(Number(i));if(o){let t;void 0!==_&&(o.size=_,void 0===h?(t=_,this._nMeasured++):t=_-h),this._tMeasured=this._tMeasured+t}})),this._nMeasured?(this._updateItemSize(),this._scheduleReflow()):console.warn("No items measured yet.")}_updateItemSize(){this._itemSize[this._sizeDim]=Math.round(this._tMeasured/this._nMeasured)}_getMetrics(t){return this._metrics[t]=this._metrics[t]||{}}_getPhysicalItem(t){return this._newPhysicalItems.get(t)||this._physicalItems.get(t)}_getSize(t){const i=this._getPhysicalItem(t);return i&&i.size}_getPosition(t){const i=this._physicalItems.get(t);return i?i.pos:t*this._delta+this._spacing}_calculateAnchor(t,i){return 0===t?0:i>this._scrollSize-this._viewDim1?this._totalItems-1:Math.max(0,Math.min(this._totalItems-1,Math.floor((t+i)/2/this._delta)))}_getAnchor(t,i){if(0===this._physicalItems.size)return this._calculateAnchor(t,i);if(this._first<0)return console.error("_getAnchor: negative _first"),this._calculateAnchor(t,i);if(this._last<0)return console.error("_getAnchor: negative _last"),this._calculateAnchor(t,i);const s=this._getPhysicalItem(this._first),e=this._getPhysicalItem(this._last),h=s.pos,_=h+s.size,o=e.pos,r=o+e.size;if(r<t)return this._calculateAnchor(t,i);if(h>i)return this._calculateAnchor(t,i);if(h>=t||_>=t)return this._first;if(r<=i||o<=i)return this._last;let l=this._last,a=this._first;for(;;){const s=Math.round((l+a)/2),e=this._physicalItems.get(s),h=e.pos,_=h+e.size;if(h>=t&&h<=i||_>=t&&_<=i)return s;_<t?a=s+1:h>i&&(l=s-1)}}_getActiveItems(){if(0===this._viewDim1||0===this._totalItems)this._clearItems();else{const t=Math.min(this._scrollSize,this._scrollPosition+this._viewDim1+this._overhang),i=Math.max(0,t-this._viewDim1-2*this._overhang);this._getItems(i,t)}}_clearItems(){this._first=-1,this._last=-1,this._physicalMin=0,this._physicalMax=0;const t=this._newPhysicalItems;this._newPhysicalItems=this._physicalItems,this._newPhysicalItems.clear(),this._physicalItems=t,this._stable=!0}_getItems(t,i){const s=this._newPhysicalItems;null!==this._anchorIdx&&null!==this._anchorPos||(this._anchorIdx=this._getAnchor(t,i),this._anchorPos=this._getPosition(this._anchorIdx));let e=this._getSize(this._anchorIdx);void 0===e&&(e=this._itemDim1);let h=0;for(this._anchorPos+e+this._spacing<t&&(h=t-(this._anchorPos+e+this._spacing)),this._anchorPos>i&&(h=i-this._anchorPos),h&&(this._scrollPosition-=h,t-=h,i-=h,this._scrollError+=h),s.set(this._anchorIdx,{pos:this._anchorPos,size:e}),this._first=this._last=this._anchorIdx,this._physicalMin=this._physicalMax=this._anchorPos,this._stable=!0;this._physicalMin>t&&this._first>0;){let t=this._getSize(--this._first);void 0===t&&(this._stable=!1,t=this._itemDim1);const i=this._physicalMin-=t+this._spacing;if(s.set(this._first,{pos:i,size:t}),!1===this._stable&&!1===this._estimate)break}for(;this._physicalMax<i&&this._last<this._totalItems;){let t=this._getSize(this._last);if(void 0===t&&(this._stable=!1,t=this._itemDim1),s.set(this._last++,{pos:this._physicalMax,size:t}),!1===this._stable&&!1===this._estimate)break;this._physicalMax+=t+this._spacing}this._last--;const _=this._calculateError();_&&(this._physicalMin-=_,this._physicalMax-=_,this._anchorPos-=_,this._scrollPosition-=_,s.forEach((t=>t.pos-=_)),this._scrollError+=_),this._stable&&(this._newPhysicalItems=this._physicalItems,this._newPhysicalItems.clear(),this._physicalItems=s)}_calculateError(){return 0===this._first?this._physicalMin:this._physicalMin<=0?this._physicalMin-this._first*this._delta:this._last===this._totalItems-1?this._physicalMax-this._scrollSize:this._physicalMax>=this._scrollSize?this._physicalMax-this._scrollSize+(this._totalItems-1-this._last)*this._delta:0}_updateScrollSize(){super._updateScrollSize(),this._scrollSize=Math.max(this._physicalMax,this._scrollSize)}_reflow(){const{_first:t,_last:i,_scrollSize:s}=this;this._updateScrollSize(),this._getActiveItems(),this._scrollIfNeeded(),this._scrollSize!==s&&this._emitScrollSize(),this._updateVisibleIndices(),this._emitRange(),-1===this._first&&-1===this._last?this._resetReflowState():this._first!==t||this._last!==i||this._needsRemeasure?(this._emitChildPositions(),this._emitScrollError()):(this._emitChildPositions(),this._emitScrollError(),this._resetReflowState())}_resetReflowState(){this._anchorIdx=null,this._anchorPos=null,this._stable=!0}_getItemPosition(t){return{[this._positionDim]:this._getPosition(t),[this._secondaryPositionDim]:0}}_getItemSize(t){return{[this._sizeDim]:this._getSize(t)||this._itemDim1,[this._secondarySizeDim]:this._itemDim2}}_viewDim2Changed(){this._needsRemeasure=!0,this._scheduleReflow()}_emitRange(){const t=this._needsRemeasure,i=this._stable;this._needsRemeasure=!1,super._emitRange({remeasure:t,stable:i})}}}}]);
//# sourceMappingURL=chunk.02611e0f03a7b5f8e028.js.map