export const __webpack_ids__=["9585"];export const __webpack_modules__={82959:function(e,t,i){i.a(e,(async function(e,s){try{i.r(t);var a=i(44249),o=i(72621),n=i(57243),r=i(50778),d=i(36522),l=i(83523),h=i(58776),c=i(76320),u=(i(23043),i(66899)),p=i(56785),v=i(32263),g=i(76131),f=i(75375),_=(i(87979),e([f]));f=(_.then?(await _)():_)[0];const m="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z";(0,a.Z)([(0,r.Mo)("hassio-ingress-view")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,r.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,r.Cb)({attribute:!1})],key:"supervisor",value:void 0},{kind:"field",decorators:[(0,r.Cb)({attribute:!1})],key:"route",value:void 0},{kind:"field",decorators:[(0,r.Cb)({attribute:!1})],key:"ingressPanel",value:()=>!1},{kind:"field",decorators:[(0,r.Cb)({type:Boolean})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,r.SB)()],key:"_addon",value:void 0},{kind:"field",decorators:[(0,r.SB)()],key:"_loadingMessage",value:void 0},{kind:"field",key:"_sessionKeepAlive",value:void 0},{kind:"field",key:"_fetchDataTimeout",value:void 0},{kind:"method",key:"disconnectedCallback",value:function(){(0,o.Z)(i,"disconnectedCallback",this,3)([]),this._sessionKeepAlive&&(clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=void 0),this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0)}},{kind:"method",key:"render",value:function(){if(!this._addon)return n.dy`<hass-loading-screen .message="${this._loadingMessage}"></hass-loading-screen>`;const e=n.dy`<iframe title="${this._addon.name}" src="${this._addon.ingress_url}" @load="${this._checkLoaded}"> </iframe>`;return this.ingressPanel?n.dy`${this.narrow||"always_hidden"===this.hass.dockedSidebar?n.dy`<div class="header"> <ha-icon-button .label="${this.hass.localize("ui.sidebar.sidebar_toggle")}" .path="${m}" @click="${this._toggleMenu}"></ha-icon-button> <div class="main-title">${this._addon.name}</div> </div> ${e}`:e}`:n.dy`<hass-subpage .hass="${this.hass}" .header="${this._addon.name}" .narrow="${this.narrow}"> ${e} </hass-subpage>`}},{kind:"method",key:"firstUpdated",value:async function(){if(""===this.route.path){const e=(0,h.io)("addon");let t;if(e){try{t=await(0,u.AD)(this.hass,e)}catch(t){return await(0,g.Ys)(this,{text:(0,p.js)(t),title:e}),await(0,c.y)(),void(0,l.c)("/hassio/store",{replace:!0})}t.version?t.ingress?(0,l.c)(`/hassio/ingress/${t.slug}`,{replace:!0}):(await(0,g.Ys)(this,{text:this.supervisor.localize("my.error_addon_no_ingress"),title:t.name}),await(0,c.y)(),(0,l.c)(`/hassio/addon/${t.slug}/info`,{replace:!0})):(await(0,g.Ys)(this,{text:this.supervisor.localize("my.error_addon_not_installed"),title:t.name}),await(0,c.y)(),(0,l.c)(`/hassio/addon/${t.slug}/info`,{replace:!0}))}}}},{kind:"method",key:"willUpdate",value:function(e){if((0,o.Z)(i,"willUpdate",this,3)([e]),!e.has("route"))return;const t=this.route.path.substring(1),s=e.get("route"),a=s?s.path.substring(1):void 0;t&&t!==a&&(this._loadingMessage=void 0,this._fetchData(t))}},{kind:"method",key:"_fetchData",value:async function(e){const t=(0,v.U)(this.hass);let i,s;try{i=await(0,u.AD)(this.hass,e)}catch(e){return await this.updateComplete,await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_info")||"Unable to fetch add-on info to start Ingress",title:"Supervisor"}),await(0,c.y)(),void(0,l.c)("/hassio/store",{replace:!0})}if(!i.version)return await this.updateComplete,await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_not_installed")||"The add-on is not installed. Please install it first",title:i.name}),await(0,c.y)(),void(0,l.c)(`/hassio/addon/${i.slug}/info`,{replace:!0});if(!i.ingress_url)return await this.updateComplete,await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_not_supported")||"This add-on does not support Ingress",title:i.name}),await(0,c.y)(),void history.back();if(!i.state||!["startup","started"].includes(i.state)){await this.updateComplete;if(!await(0,g.g7)(this,{text:this.supervisor.localize("ingress.error_addon_not_running")||"The add-on is not running. Do you want to start it now?",title:i.name,confirmText:this.supervisor.localize("ingress.start_addon")||"Start add-on",dismissText:this.supervisor.localize("common.no")||"No"}))return await(0,c.y)(),void(0,l.c)(`/hassio/addon/${i.slug}/info`,{replace:!0});try{return this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",await(0,u.kP)(this.hass,e),(0,d.B)(this,"supervisor-collection-refresh",{collection:"addon"}),void this._fetchData(e)}catch(e){return await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_starting_addon")||"Error starting the add-on",title:i.name}),await(0,c.y)(),void(0,l.c)(`/hassio/addon/${i.slug}/logs`,{replace:!0})}}if("startup"===i.state)return this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",void(this._fetchDataTimeout=window.setTimeout((()=>{this._fetchData(e)}),500));if("started"===i.state){this._loadingMessage=void 0,this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0);try{s=await t}catch(e){return this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_creating_session")||"Unable to create an Ingress session",title:i.name}),await(0,c.y)(),void history.back()}this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=window.setInterval((async()=>{try{await(0,v.n)(this.hass,s)}catch(e){s=await(0,v.U)(this.hass)}}),6e4),this._addon=i}}},{kind:"method",key:"_checkLoaded",value:async function(e){this._addon&&"502: Bad Gateway"===e.target.contentDocument.body.textContent&&(await this.updateComplete,(0,g.g7)(this,{text:this.supervisor.localize("ingress.error_addon_not_ready")||"The add-on seems to not be ready, it might still be starting. Do you want to try again?",title:this._addon.name,confirmText:this.supervisor.localize("ingress.retry")||"Retry",dismissText:this.supervisor.localize("common.no")||"No",confirm:async()=>{const e=this._addon;this._addon=void 0,await Promise.all([this.updateComplete,new Promise((e=>{setTimeout(e,500)}))]),this._addon=e}}))}},{kind:"method",key:"_toggleMenu",value:function(){(0,d.B)(this,"hass-toggle-menu")}},{kind:"field",static:!0,key:"styles",value:()=>n.iv`iframe{display:block;width:100%;height:100%;border:0}.header+iframe{height:calc(100% - 40px)}.header{display:flex;align-items:center;font-size:16px;height:40px;padding:0 16px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:400;color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box;--mdc-icon-size:20px}.main-title{margin:var(--margin-title);line-height:20px;flex-grow:1}ha-icon-button{pointer-events:auto}hass-subpage{--app-header-background-color:var(--sidebar-background-color);--app-header-text-color:var(--sidebar-text-color);--app-header-border-bottom:1px solid var(--divider-color)}`}]}}),n.oi);s()}catch(e){s(e)}}))},58776:function(e,t,i){i.d(t,{Q2:()=>a,io:()=>o,ou:()=>n});i(9359),i(31526),i(75656),i(50100),i(18084);var s=i(14463);const a=()=>{const e={},t=new URLSearchParams(s.E.location.search);for(const[i,s]of t.entries())e[i]=s;return e},o=e=>new URLSearchParams(s.E.location.search).get(e),n=e=>{const t=new URLSearchParams;return Object.entries(e).forEach((([e,i])=>{t.append(e,i)})),t.toString()}},32263:function(e,t,i){i.d(t,{U:()=>o,n:()=>n});var s=i(17803);function a(e){return document.cookie=`ingress_session=${e};path=/api/hassio_ingress/;SameSite=Strict${"https:"===location.protocol?";Secure":""}`,e}const o=async e=>{if((0,s.I)(e.config.version,2021,2,4)){return a((await e.callWS({type:"supervisor/api",endpoint:"/ingress/session",method:"post"})).session)}return a((await e.callApi("POST","hassio/ingress/session")).data.session)},n=async(e,t)=>{(0,s.I)(e.config.version,2021,2,4)?await e.callWS({type:"supervisor/api",endpoint:"/ingress/validate_session",method:"post",data:{session:t}}):await e.callApi("POST","hassio/ingress/validate_session",{session:t})}},1451:function(e){var t=TypeError;e.exports=function(e,i){if(e<i)throw new t("Not enough arguments");return e}},75656:function(e,t,i){var s=i(99473),a=i(72878),o=i(72616),n=i(1451),r=URLSearchParams,d=r.prototype,l=a(d.append),h=a(d.delete),c=a(d.forEach),u=a([].push),p=new r("a=1&a=2&b=3");p.delete("a",1),p.delete("b",void 0),p+""!="a=2"&&s(d,"delete",(function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return h(this,e);var s=[];c(this,(function(e,t){u(s,{key:t,value:e})})),n(t,1);for(var a,r=o(e),d=o(i),p=0,v=0,g=!1,f=s.length;p<f;)a=s[p++],g||a.key===r?(g=!0,h(this,a.key)):v++;for(;v<f;)(a=s[v++]).key===r&&a.value===d||l(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},50100:function(e,t,i){var s=i(99473),a=i(72878),o=i(72616),n=i(1451),r=URLSearchParams,d=r.prototype,l=a(d.getAll),h=a(d.has),c=new r("a=1");!c.has("a",2)&&c.has("a",void 0)||s(d,"has",(function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return h(this,e);var s=l(this,e);n(t,1);for(var a=o(i),r=0;r<s.length;)if(s[r++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},18084:function(e,t,i){var s=i(85779),a=i(72878),o=i(27803),n=URLSearchParams.prototype,r=a(n.forEach);s&&!("size"in n)&&o(n,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})}};
//# sourceMappingURL=9585.18ffe097fcfc2422.js.map