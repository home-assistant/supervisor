export const __webpack_ids__=["981"];export const __webpack_modules__={70731:function(e,t,s){s.a(e,async function(e,a){try{s.r(t);var i=s(73742),o=s(59048),r=s(7616),n=s(39884),d=s(67050),h=s(64637),c=s(65863),l=(s(81777),s(81276)),u=s(31021),p=s(21534),g=s(72242),v=s(41906),_=(s(51869),e([v]));v=(_.then?(await _)():_)[0];const f="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z";class m extends o.oi{disconnectedCallback(){super.disconnectedCallback(),this._sessionKeepAlive&&(clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=void 0),this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0)}render(){if(!this._addon)return o.dy`<hass-loading-screen .message="${this._loadingMessage}"></hass-loading-screen>`;const e=o.dy`<iframe title="${this._addon.name}" src="${this._addon.ingress_url}" @load="${this._checkLoaded}"> </iframe>`;return this.ingressPanel?o.dy`${this.narrow||"always_hidden"===this.hass.dockedSidebar?o.dy`<div class="header"> <ha-icon-button .label="${this.hass.localize("ui.sidebar.sidebar_toggle")}" .path="${f}" @click="${this._toggleMenu}"></ha-icon-button> <div class="main-title">${this._addon.name}</div> </div> ${e}`:e}`:o.dy`<hass-subpage .hass="${this.hass}" .header="${this._addon.name}" .narrow="${this.narrow}"> ${e} </hass-subpage>`}async firstUpdated(){if(""===this.route.path){const e=(0,h.io)("addon");let t;if(e){try{t=await(0,l.AD)(this.hass,e)}catch(t){return await(0,g.Ys)(this,{text:(0,u.js)(t),title:e}),await(0,c.y)(),void(0,d.c)("/hassio/store",{replace:!0})}t.version?t.ingress?(0,d.c)(`/hassio/ingress/${t.slug}`,{replace:!0}):(await(0,g.Ys)(this,{text:this.supervisor.localize("my.error_addon_no_ingress"),title:t.name}),await(0,c.y)(),(0,d.c)(`/hassio/addon/${t.slug}/info`,{replace:!0})):(await(0,g.Ys)(this,{text:this.supervisor.localize("my.error_addon_not_installed"),title:t.name}),await(0,c.y)(),(0,d.c)(`/hassio/addon/${t.slug}/info`,{replace:!0}))}}}willUpdate(e){if(super.willUpdate(e),!e.has("route"))return;const t=this.route.path.substring(1),s=e.get("route"),a=s?s.path.substring(1):void 0;t&&t!==a&&(this._loadingMessage=void 0,this._fetchData(t))}async _fetchData(e){const t=(0,p.U)(this.hass);let s,a;try{s=await(0,l.AD)(this.hass,e)}catch(e){return await this.updateComplete,await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_info")||"Unable to fetch add-on info to start Ingress",title:"Supervisor"}),await(0,c.y)(),void(0,d.c)("/hassio/store",{replace:!0})}if(!s.version)return await this.updateComplete,await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_not_installed")||"The add-on is not installed. Please install it first",title:s.name}),await(0,c.y)(),void(0,d.c)(`/hassio/addon/${s.slug}/info`,{replace:!0});if(!s.ingress_url)return await this.updateComplete,await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_not_supported")||"This add-on does not support Ingress",title:s.name}),await(0,c.y)(),void history.back();if(!s.state||!["startup","started"].includes(s.state)){await this.updateComplete;if(!await(0,g.g7)(this,{text:this.supervisor.localize("ingress.error_addon_not_running")||"The add-on is not running. Do you want to start it now?",title:s.name,confirmText:this.supervisor.localize("ingress.start_addon")||"Start add-on",dismissText:this.supervisor.localize("common.no")||"No"}))return await(0,c.y)(),void(0,d.c)(`/hassio/addon/${s.slug}/info`,{replace:!0});try{return this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",await(0,l.kP)(this.hass,e),(0,n.B)(this,"supervisor-collection-refresh",{collection:"addon"}),void this._fetchData(e)}catch(e){return await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_starting_addon")||"Error starting the add-on",title:s.name}),await(0,c.y)(),void(0,d.c)(`/hassio/addon/${s.slug}/logs`,{replace:!0})}}if("startup"===s.state)return this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",void(this._fetchDataTimeout=window.setTimeout(()=>{this._fetchData(e)},500));if("started"===s.state){this._loadingMessage=void 0,this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0);try{a=await t}catch(e){return this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),await(0,g.Ys)(this,{text:this.supervisor.localize("ingress.error_creating_session")||"Unable to create an Ingress session",title:s.name}),await(0,c.y)(),void history.back()}this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=window.setInterval(async()=>{try{await(0,p.n)(this.hass,a)}catch(e){a=await(0,p.U)(this.hass)}},6e4),this._addon=s}}async _checkLoaded(e){this._addon&&"502: Bad Gateway"===e.target.contentDocument.body.textContent&&(await this.updateComplete,(0,g.g7)(this,{text:this.supervisor.localize("ingress.error_addon_not_ready")||"The add-on seems to not be ready, it might still be starting. Do you want to try again?",title:this._addon.name,confirmText:this.supervisor.localize("ingress.retry")||"Retry",dismissText:this.supervisor.localize("common.no")||"No",confirm:async()=>{const e=this._addon;this._addon=void 0,await Promise.all([this.updateComplete,new Promise(e=>{setTimeout(e,500)})]),this._addon=e}}))}_toggleMenu(){(0,n.B)(this,"hass-toggle-menu")}constructor(...e){super(...e),this.ingressPanel=!1,this.narrow=!1}}m.styles=o.iv`iframe{display:block;width:100%;height:100%;border:0}.header+iframe{height:calc(100% - 40px)}.header{display:flex;align-items:center;font-size:var(--ha-font-size-l);height:40px;padding:0 16px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box;--mdc-icon-size:20px}.main-title{margin:var(--margin-title);line-height:var(--ha-line-height-condensed);flex-grow:1}ha-icon-button{pointer-events:auto}hass-subpage{--app-header-background-color:var(--sidebar-background-color);--app-header-text-color:var(--sidebar-text-color);--app-header-border-bottom:1px solid var(--divider-color)}`,(0,i.__decorate)([(0,r.Cb)({attribute:!1})],m.prototype,"hass",void 0),(0,i.__decorate)([(0,r.Cb)({attribute:!1})],m.prototype,"supervisor",void 0),(0,i.__decorate)([(0,r.Cb)({attribute:!1})],m.prototype,"route",void 0),(0,i.__decorate)([(0,r.Cb)({attribute:!1})],m.prototype,"ingressPanel",void 0),(0,i.__decorate)([(0,r.Cb)({type:Boolean})],m.prototype,"narrow",void 0),(0,i.__decorate)([(0,r.SB)()],m.prototype,"_addon",void 0),(0,i.__decorate)([(0,r.SB)()],m.prototype,"_loadingMessage",void 0),m=(0,i.__decorate)([(0,r.Mo)("hassio-ingress-view")],m),a()}catch(e){a(e)}})},64637:function(e,t,s){s.d(t,{Q2:()=>i,io:()=>o,ou:()=>r});s(81738),s(22960),s(36330),s(38221),s(75863);var a=s(88479);const i=()=>{const e={},t=new URLSearchParams(a.E.location.search);for(const[s,a]of t.entries())e[s]=a;return e},o=e=>new URLSearchParams(a.E.location.search).get(e),r=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{t.append(e,s)}),t.toString()}},21534:function(e,t,s){s.d(t,{U:()=>o,n:()=>r});var a=s(43893);function i(e){return document.cookie=`ingress_session=${e};path=/api/hassio_ingress/;SameSite=Strict${"https:"===location.protocol?";Secure":""}`,e}const o=async e=>{if((0,a.I)(e.config.version,2021,2,4)){return i((await e.callWS({type:"supervisor/api",endpoint:"/ingress/session",method:"post"})).session)}return i((await e.callApi("POST","hassio/ingress/session")).data.session)},r=async(e,t)=>{(0,a.I)(e.config.version,2021,2,4)?await e.callWS({type:"supervisor/api",endpoint:"/ingress/validate_session",method:"post",data:{session:t}}):await e.callApi("POST","hassio/ingress/validate_session",{session:t})}},60968:function(e){var t=TypeError;e.exports=function(e,s){if(e<s)throw new t("Not enough arguments");return e}},36330:function(e,t,s){var a=s(40453),i=s(12814),o=s(43576),r=s(60968),n=URLSearchParams,d=n.prototype,h=i(d.append),c=i(d.delete),l=i(d.forEach),u=i([].push),p=new n("a=1&a=2&b=3");p.delete("a",1),p.delete("b",void 0),p+""!="a=2"&&a(d,"delete",function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return c(this,e);var a=[];l(this,function(e,t){u(a,{key:t,value:e})}),r(t,1);for(var i,n=o(e),d=o(s),p=0,g=0,v=!1,_=a.length;p<_;)i=a[p++],v||i.key===n?(v=!0,c(this,i.key)):g++;for(;g<_;)(i=a[g++]).key===n&&i.value===d||h(this,i.key,i.value)},{enumerable:!0,unsafe:!0})},38221:function(e,t,s){var a=s(40453),i=s(12814),o=s(43576),r=s(60968),n=URLSearchParams,d=n.prototype,h=i(d.getAll),c=i(d.has),l=new n("a=1");!l.has("a",2)&&l.has("a",void 0)||a(d,"has",function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return c(this,e);var a=h(this,e);r(t,1);for(var i=o(s),n=0;n<a.length;)if(a[n++]===i)return!0;return!1},{enumerable:!0,unsafe:!0})},75863:function(e,t,s){var a=s(61360),i=s(12814),o=s(42749),r=URLSearchParams.prototype,n=i(r.forEach);a&&!("size"in r)&&o(r,"size",{get:function(){var e=0;return n(this,function(){e++}),e},configurable:!0,enumerable:!0})}};
//# sourceMappingURL=981.139bd24b79739267.js.map