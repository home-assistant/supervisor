export const __rspack_esm_id="8142";export const __rspack_esm_ids=["8142"];export const __webpack_modules__={78870(e,t,i){i.d(t,{M:()=>a,l:()=>s});i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698);const s=new Set(["primary","accent","red","pink","purple","deep-purple","indigo","blue","light-blue","cyan","teal","green","light-green","lime","yellow","amber","orange","deep-orange","brown","light-grey","grey","dark-grey","blue-grey","black","white","primary-text","secondary-text","disabled"]);function a(e){return s.has(e)?`var(--${e}-color)`:e}},65522(e,t,i){i.d(t,{A:()=>s});const s=e=>e.name?.trim()},79(e,t,i){i.d(t,{xn:()=>r,T:()=>n});i(18111),i(22489),i(61701);var s=i(22786);i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698);var a=i(28978);const r=e=>(e.name_by_user||e.name)?.trim(),n=(e,t,i)=>r(e)||i&&o(t,i)||t.localize("ui.panel.config.devices.unnamed_device",{type:t.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)}),o=(e,t)=>{for(const i of t||[]){const t="string"==typeof i?i:i.entity_id,s=e.states[t];if(s)return(0,a.u)(s)}};(0,s.A)(e=>function(e){const t=new Set,i=new Set;for(const s of e)i.has(s)?t.add(s):i.add(s);return t}(Object.values(e).map(e=>r(e)).filter(e=>void 0!==e)))},4358(e,t,i){i.d(t,{aH:()=>o});var s=i(79),a=i(28978);const r=[" ",": "," - "],n=e=>e.toLowerCase()!==e,o=(e,t,i)=>{const s=t[e.entity_id];return s?d(s,i):(0,a.u)(e)},d=(e,t,i)=>{const o=e.name||("original_name"in e&&null!=e.original_name?String(e.original_name):void 0),d=e.device_id?t[e.device_id]:void 0;if(!d)return o||(i?(0,a.u)(i):void 0);const l=(0,s.xn)(d);return l!==o?l&&o&&((e,t)=>{const i=e.toLowerCase(),s=t.toLowerCase();for(const t of r){const a=`${s}${t}`;if(i.startsWith(a)){const t=e.substring(a.length);if(t.length)return n(t.substr(0,t.indexOf(" ")))?t:t[0].toUpperCase()+t.slice(1)}}})(o,l)||o:void 0}},74705(e,t,i){i.d(t,{Cf:()=>d});i(18111),i(81148),i(22489),i(61701),i(13579);var s=i(65522),a=i(79),r=i(4358),n=i(55931),o=i(28455);const d=(e,t,i,d,l,c)=>{const{device:h,area:p,floor:u}=(0,o.l)(e,i,d,l,c);return t.map(t=>{switch(t.type){case"entity":return(0,r.aH)(e,i,d);case"device":return h?(0,a.xn)(h):void 0;case"area":return p?(0,s.A)(p):void 0;case"floor":return u?(0,n.X)(u):void 0;case"text":return t.text;default:return""}})}},55931(e,t,i){i.d(t,{X:()=>s});const s=e=>e.name?.trim()},68246(e,t,i){i.d(t,{Y:()=>s});const s=e=>e.slice(e.indexOf(".")+1)},28978(e,t,i){i.d(t,{u:()=>a});var s=i(68246);const a=e=>{return t=e.entity_id,void 0===(i=e.attributes).friendly_name?(0,s.Y)(t).replace(/_/g," "):(i.friendly_name??"").toString();var t,i}},76774(e,t,i){i.d(t,{w:()=>s});const s=(e,t)=>{const i=e.area_id,s=i?t.areas[i]:void 0,a=s?.floor_id;return{device:e,area:s||null,floor:(a?t.floors[a]:void 0)||null}}},28455(e,t,i){i.d(t,{l:()=>s});const s=(e,t,i,s,r)=>{const n=t[e.entity_id];return n?a(n,t,i,s,r):{entity:null,device:null,area:null,floor:null}},a=(e,t,i,s,a)=>{const r=t[e.entity_id],n=e?.device_id,o=n?i[n]:void 0,d=e?.area_id||o?.area_id,l=d?s[d]:void 0,c=l?.floor_id;return{entity:r,device:o||null,area:l||null,floor:(c?a[c]:void 0)||null}}},78649(e,t,i){i.d(t,{n:()=>a});const s=/^(\w+)\.(\w+)$/,a=e=>s.test(e)},80880(e,t,i){i.d(t,{Y:()=>s});const s=(e,t="_")=>{const i="àáâäæãåāăąабçćčđďдèéêëēėęěеёэфğǵгḧхîïíīįìıİийкłлḿмñńǹňнôöòóœøōõőоṕпŕřрßśšşșсťțтûüùúūǘůűųувẃẍÿýыžźżз·",s=`aaaaaaaaaaabcccdddeeeeeeeeeeefggghhiiiiiiiiijkllmmnnnnnoooooooooopprrrsssssstttuuuuuuuuuuvwxyyyzzzz${t}`,a=new RegExp(i.split("").join("|"),"g"),r={ж:"zh",х:"kh",ц:"ts",ч:"ch",ш:"sh",щ:"shch",ю:"iu",я:"ia"};let n;return""===e?n="":(n=e.toString().toLowerCase().replace(a,e=>s.charAt(i.indexOf(e))).replace(/[а-я]/g,e=>r[e]||"").replace(/(\d),(?=\d)/g,"$1").replace(/[^a-z0-9]+/g,t).replace(new RegExp(`(${t})\\1+`,"g"),"$1").replace(new RegExp(`^${t}+`),"").replace(new RegExp(`${t}+$`),""),""===n&&(n="unknown")),n}},11382(e,t,i){var s=i(62826),a=i(96196),r=i(77845),n=i(94333),o=i(1087),d=i(12587);i(67094);class l extends a.WF{render(){const e=this.noCollapse?a.s6:a.qy` <ha-svg-icon .path="${"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"}" class="summary-icon ${(0,n.H)({expanded:this.expanded})}"></ha-svg-icon> `;return a.qy` <div class="top ${(0,n.H)({expanded:this.expanded})}"> <div id="summary" class="${(0,n.H)({noCollapse:this.noCollapse})}" @click="${this._toggleContainer}" @keydown="${this._toggleContainer}" @focus="${this._focusChanged}" @blur="${this._focusChanged}" role="button" tabindex="${this.noCollapse?-1:0}" aria-expanded="${this.expanded}" aria-controls="sect1" part="summary"> ${this.leftChevron?e:a.s6} <slot name="leading-icon"></slot> <slot name="header"> <div class="header"> ${this.header} <slot class="secondary" name="secondary">${this.secondary}</slot> </div> </slot> ${this.leftChevron?a.s6:e} <slot name="icons"></slot> </div> </div> <div class="container ${(0,n.H)({expanded:this.expanded})}" @transitionend="${this._handleTransitionEnd}" role="region" aria-labelledby="summary" aria-hidden="${!this.expanded}" tabindex="-1"> ${this._showContent?a.qy`<slot></slot>`:""} </div> `}willUpdate(e){super.willUpdate(e),e.has("expanded")&&(this._showContent=this.expanded,setTimeout(()=>{this._container.style.overflow=this.expanded?"initial":"hidden"},300))}_handleTransitionEnd(){this._container.style.removeProperty("height"),this._container.style.overflow=this.expanded?"initial":"hidden",this._showContent=this.expanded}async _toggleContainer(e){if(e.defaultPrevented)return;if("keydown"===e.type&&"Enter"!==e.key&&" "!==e.key)return;if(e.preventDefault(),this.noCollapse)return;const t=!this.expanded;(0,o.r)(this,"expanded-will-change",{expanded:t}),this._container.style.overflow="hidden",t&&(this._showContent=!0,await(0,d.E)());const i=this._container.scrollHeight;this._container.style.height=`${i}px`,t||setTimeout(()=>{this._container.style.height="0px"},0),this.expanded=t,(0,o.r)(this,"expanded-changed",{expanded:this.expanded})}_focusChanged(e){this.noCollapse||this.shadowRoot.querySelector(".top").classList.toggle("focused","focus"===e.type)}constructor(...e){super(...e),this.expanded=!1,this.outlined=!1,this.leftChevron=!1,this.noCollapse=!1,this._showContent=this.expanded}}l.styles=a.AH`:host{display:block}.top{display:flex;align-items:center;border-radius:var(--ha-card-border-radius,var(--ha-border-radius-lg))}.top.expanded{border-bottom-left-radius:0px;border-bottom-right-radius:0px}.top.focused{background:var(--input-fill-color)}:host([outlined]){box-shadow:none;border-width:1px;border-style:solid;border-color:var(--outline-color);border-radius:var(--ha-card-border-radius,var(--ha-border-radius-lg))}.summary-icon{transition:transform 150ms cubic-bezier(.4, 0, .2, 1);direction:var(--direction);margin-left:8px;margin-inline-start:8px;margin-inline-end:initial;border-radius:var(--ha-border-radius-circle)}#summary:focus-visible ha-svg-icon.summary-icon{background-color:var(--ha-color-fill-neutral-normal-active)}::slotted([slot=leading-icon]),:host([left-chevron]) .summary-icon{margin-left:0;margin-right:8px;margin-inline-start:0;margin-inline-end:8px}#summary{flex:1;display:flex;padding:var(--expansion-panel-summary-padding,0 8px);min-height:48px;align-items:center;cursor:pointer;overflow:hidden;font-weight:var(--ha-font-weight-medium);outline:0}#summary.noCollapse{cursor:default}.summary-icon.expanded{transform:rotate(180deg)}.header,::slotted([slot=header]){flex:1;overflow-wrap:anywhere;color:var(--primary-text-color)}.container{padding:var(--expansion-panel-content-padding,0 8px);overflow:hidden;transition:height .3s cubic-bezier(.4, 0, .2, 1);height:0px}.container.expanded{height:auto}.secondary{display:block;color:var(--secondary-text-color);font-size:var(--ha-font-size-s)}`,(0,s.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],l.prototype,"expanded",void 0),(0,s.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],l.prototype,"outlined",void 0),(0,s.Cg)([(0,r.MZ)({attribute:"left-chevron",type:Boolean,reflect:!0})],l.prototype,"leftChevron",void 0),(0,s.Cg)([(0,r.MZ)({attribute:"no-collapse",type:Boolean,reflect:!0})],l.prototype,"noCollapse",void 0),(0,s.Cg)([(0,r.MZ)()],l.prototype,"header",void 0),(0,s.Cg)([(0,r.MZ)()],l.prototype,"secondary",void 0),(0,s.Cg)([(0,r.wk)()],l.prototype,"_showContent",void 0),(0,s.Cg)([(0,r.P)(".container")],l.prototype,"_container",void 0),l=(0,s.Cg)([(0,r.EM)("ha-expansion-panel")],l)},18198(e,t,i){i.d(t,{Si:()=>n});var s=i(62826),a=i(96196),r=i(77845);i(67094);const n=e=>{switch(e.level){case 0:return"M11,10H13V16H11V10M22,12H19V20H5V12H2L12,3L22,12M15,10A2,2 0 0,0 13,8H11A2,2 0 0,0 9,10V16A2,2 0 0,0 11,18H13A2,2 0 0,0 15,16V10Z";case 1:return"M12,3L2,12H5V20H19V12H22L12,3M10,8H14V18H12V10H10V8Z";case 2:return"M12,3L2,12H5V20H19V12H22L12,3M9,8H13A2,2 0 0,1 15,10V12A2,2 0 0,1 13,14H11V16H15V18H9V14A2,2 0 0,1 11,12H13V10H9V8Z";case 3:return"M12,3L22,12H19V20H5V12H2L12,3M15,11.5V10C15,8.89 14.1,8 13,8H9V10H13V12H11V14H13V16H9V18H13A2,2 0 0,0 15,16V14.5A1.5,1.5 0 0,0 13.5,13A1.5,1.5 0 0,0 15,11.5Z";case-1:return"M12,3L2,12H5V20H19V12H22L12,3M11,15H7V13H11V15M15,18H13V10H11V8H15V18Z"}return"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"};class o extends a.WF{render(){if(!this.floor)return a.s6;if(this.floor.icon)return a.qy`<ha-icon .icon="${this.floor.icon}"></ha-icon>`;const e=n(this.floor);return a.qy`<ha-svg-icon .path="${e}"></ha-svg-icon>`}}(0,s.Cg)([(0,r.MZ)({attribute:!1})],o.prototype,"floor",void 0),(0,s.Cg)([(0,r.MZ)()],o.prototype,"icon",void 0),o=(0,s.Cg)([(0,r.EM)("ha-floor-icon")],o)},17308(e,t,i){var s=i(62826),a=i(49838),r=i(11245),n=i(96196),o=i(77845);class d extends a.B{}d.styles=[r.R,n.AH`:host{--md-sys-color-surface:var(--card-background-color)}`],d=(0,s.Cg)([(0,o.EM)("ha-md-list")],d)},84909(e,t,i){i.a(e,async function(e,s){try{i.r(t),i.d(t,{HaTargetSelector:()=>m});i(18111),i(13579);var a=i(62826),r=i(96196),n=i(77845),o=i(22786),d=i(44537),l=i(44927),c=i(55053),h=i(95311),p=i(79286),u=e([p]);p=(u.then?(await u)():u)[0];class m extends r.WF{_hasIntegration(e){return e.target?.entity&&(0,d.e)(e.target.entity).some(e=>e.integration)||e.target?.device&&(0,d.e)(e.target.device).some(e=>e.integration)}updated(e){super.updated(e),e.has("selector")&&this._hasIntegration(this.selector)&&!this._entitySources&&(0,c.c)(this.hass).then(e=>{this._entitySources=e}),e.has("selector")&&(this._createDomains=(0,h.Lo)(this.selector))}render(){return this._hasIntegration(this.selector)&&!this._entitySources?r.s6:r.qy` ${this.label?r.qy`<label>${this.label}</label>`:r.s6} <ha-target-picker .hass="${this.hass}" .value="${this.value}" .helper="${this.helper}" .deviceFilter="${this._filterDevices}" .entityFilter="${this._filterEntities}" .disabled="${this.disabled}" .createDomains="${this._createDomains}"></ha-target-picker>`}constructor(...e){super(...e),this.disabled=!1,this._deviceIntegrationLookup=(0,o.A)(l.fk),this._filterEntities=e=>!this.selector.target?.entity||(0,d.e)(this.selector.target.entity).some(t=>(0,h.Ru)(t,e,this._entitySources)),this._filterDevices=e=>{if(!this.selector.target?.device)return!0;const t=this._entitySources?this._deviceIntegrationLookup(this._entitySources,Object.values(this.hass.entities)):void 0;return(0,d.e)(this.selector.target.device).some(i=>(0,h.vX)(i,e,t))}}}m.styles=r.AH`ha-target-picker{display:block}`,(0,a.Cg)([(0,n.MZ)({attribute:!1})],m.prototype,"hass",void 0),(0,a.Cg)([(0,n.MZ)({attribute:!1})],m.prototype,"selector",void 0),(0,a.Cg)([(0,n.MZ)({type:Object})],m.prototype,"value",void 0),(0,a.Cg)([(0,n.MZ)()],m.prototype,"label",void 0),(0,a.Cg)([(0,n.MZ)()],m.prototype,"helper",void 0),(0,a.Cg)([(0,n.MZ)({type:Boolean})],m.prototype,"disabled",void 0),(0,a.Cg)([(0,n.wk)()],m.prototype,"_entitySources",void 0),(0,a.Cg)([(0,n.wk)()],m.prototype,"_createDomains",void 0),m=(0,a.Cg)([(0,n.EM)("ha-selector-target")],m),s()}catch(e){s(e)}})},93367(e,t,i){i.a(e,async function(e,t){try{var s=i(62826),a=i(96196),r=i(77845),n=i(3890),o=i(69093),d=i(85694),l=(i(67094),e([d]));d=(l.then?(await l)():l)[0];class c extends a.WF{render(){const e=this.icon||this.stateObj&&this.hass?.entities[this.stateObj.entity_id]?.icon||this.stateObj?.attributes.icon;if(e)return a.qy`<ha-icon .icon="${e}"></ha-icon>`;if(!this.stateObj)return a.s6;if(!this.hass)return this._renderFallback();const t=(0,d.fq)(this.hass,this.stateObj,this.stateValue).then(e=>e?a.qy`<ha-icon .icon="${e}"></ha-icon>`:this._renderFallback());return a.qy`${(0,n.T)(t)}`}_renderFallback(){const e=(0,o.t)(this.stateObj);return a.qy` <ha-svg-icon .path="${d.l[e]||d.lW}"></ha-svg-icon> `}}(0,s.Cg)([(0,r.MZ)({attribute:!1})],c.prototype,"hass",void 0),(0,s.Cg)([(0,r.MZ)({attribute:!1})],c.prototype,"stateObj",void 0),(0,s.Cg)([(0,r.MZ)({attribute:!1})],c.prototype,"stateValue",void 0),(0,s.Cg)([(0,r.MZ)()],c.prototype,"icon",void 0),c=(0,s.Cg)([(0,r.EM)("ha-state-icon")],c),t()}catch(e){t(e)}})},79286(e,t,i){i.a(e,async function(e,t){try{i(44114),i(18111),i(22489),i(7588),i(61701);var s=i(62826),a=i(61366),r=i(16527),n=i(94454),o=i(78648),d=i(96196),l=i(77845),c=i(29485),h=i(22786),p=i(44537),u=i(1087),m=i(78649),y=i(52220),g=i(15638),v=i(76952),_=i(77423),f=i(38911),b=i(31422),$=i(53756),x=i(95350),C=i(5904),k=i(88555),w=i(54706),M=i(24367),H=i(19711),L=i(59653),V=i(44144),I=i(38508),D=(i(67094),i(73150),i(22099)),F=i(69404),Z=e([a,I,D,F]);[a,I,D,F]=Z.then?(await Z)():Z;const q="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",E="M20 2H4C2.9 2 2 2.9 2 4V20C2 21.11 2.9 22 4 22H20C21.11 22 22 21.11 22 20V4C22 2.9 21.11 2 20 2M4 6L6 4H10.9L4 10.9V6M4 13.7L13.7 4H18.6L4 18.6V13.7M20 18L18 20H13.1L20 13.1V18M20 10.3L10.3 20H5.4L20 5.4V10.3Z",z="________",A="___create-new-entity___";class j extends((0,w.E)(d.WF)){get _showEntityId(){return this.hass.userData?.showEntityIdPicker}willUpdate(e){super.willUpdate(e),this.hasUpdated||this._loadConfigEntries()}render(){return this.addOnTop?d.qy` ${this._renderPicker()} ${this._renderItems()} `:d.qy` ${this._renderItems()} ${this._renderPicker()} `}_renderValueChips(){const e=this.value?.entity_id?(0,p.e)(this.value.entity_id):[],t=this.value?.device_id?(0,p.e)(this.value.device_id):[],i=this.value?.area_id?(0,p.e)(this.value.area_id):[],s=this.value?.floor_id?(0,p.e)(this.value.floor_id):[],a=this.value?.label_id?(0,p.e)(this.value.label_id):[];return e.length||t.length||i.length||s.length||a.length?d.qy` <div class="mdc-chip-set items"> ${s.length?s.map(e=>d.qy` <ha-target-picker-value-chip .hass="${this.hass}" type="floor" .itemId="${e}" @remove-target-item="${this._handleRemove}" @expand-target-item="${this._handleExpand}"></ha-target-picker-value-chip> `):d.s6} ${i.length?i.map(e=>d.qy` <ha-target-picker-value-chip .hass="${this.hass}" type="area" .itemId="${e}" @remove-target-item="${this._handleRemove}" @expand-target-item="${this._handleExpand}"></ha-target-picker-value-chip> `):d.s6} ${t.length?t.map(e=>d.qy` <ha-target-picker-value-chip .hass="${this.hass}" type="device" .itemId="${e}" @remove-target-item="${this._handleRemove}" @expand-target-item="${this._handleExpand}"></ha-target-picker-value-chip> `):d.s6} ${e.length?e.map(e=>d.qy` <ha-target-picker-value-chip .hass="${this.hass}" type="entity" .itemId="${e}" @remove-target-item="${this._handleRemove}" @expand-target-item="${this._handleExpand}"></ha-target-picker-value-chip> `):d.s6} ${a.length?a.map(e=>d.qy` <ha-target-picker-value-chip .hass="${this.hass}" type="label" .itemId="${e}" @remove-target-item="${this._handleRemove}" @expand-target-item="${this._handleExpand}"></ha-target-picker-value-chip> `):d.s6} </div> `:d.s6}_renderValueGroups(){const e=this.value?.entity_id?(0,p.e)(this.value.entity_id):[],t=this.value?.device_id?(0,p.e)(this.value.device_id):[],i=this.value?.area_id?(0,p.e)(this.value.area_id):[],s=this.value?.floor_id?(0,p.e)(this.value.floor_id):[],a=this.value?.label_id?(0,p.e)(this.value?.label_id):[];return e.length||t.length||i.length||s.length||a.length?d.qy` <div class="item-groups"> ${e.length?d.qy` <ha-target-picker-item-group @remove-target-item="${this._handleRemove}" type="entity" .hass="${this.hass}" .items="${{entity:e}}" .deviceFilter="${this.deviceFilter}" .entityFilter="${this.entityFilter}" .includeDomains="${this.includeDomains}" .includeDeviceClasses="${this.includeDeviceClasses}"> </ha-target-picker-item-group> `:d.s6} ${t.length?d.qy` <ha-target-picker-item-group @remove-target-item="${this._handleRemove}" type="device" .hass="${this.hass}" .items="${{device:t}}" .deviceFilter="${this.deviceFilter}" .entityFilter="${this.entityFilter}" .includeDomains="${this.includeDomains}" .includeDeviceClasses="${this.includeDeviceClasses}"> </ha-target-picker-item-group> `:d.s6} ${s.length||i.length?d.qy` <ha-target-picker-item-group @remove-target-item="${this._handleRemove}" type="area" .hass="${this.hass}" .items="${{floor:s,area:i}}" .deviceFilter="${this.deviceFilter}" .entityFilter="${this.entityFilter}" .includeDomains="${this.includeDomains}" .includeDeviceClasses="${this.includeDeviceClasses}"> </ha-target-picker-item-group> `:d.s6} ${a.length?d.qy` <ha-target-picker-item-group @remove-target-item="${this._handleRemove}" type="label" .hass="${this.hass}" .items="${{label:a}}" .deviceFilter="${this.deviceFilter}" .entityFilter="${this.entityFilter}" .includeDomains="${this.includeDomains}" .includeDeviceClasses="${this.includeDeviceClasses}"> </ha-target-picker-item-group> `:d.s6} </div> `:d.s6}_renderItems(){return d.qy` ${this.compact?this._renderValueChips():this._renderValueGroups()} `}_renderPicker(){const e=[{id:"entity",label:this.hass.localize("ui.components.target-picker.type.entities")},{id:"device",label:this.hass.localize("ui.components.target-picker.type.devices")},{id:"area",label:this.hass.localize("ui.components.target-picker.type.areas")},"separator",{id:"label",label:this.hass.localize("ui.components.target-picker.type.labels")}];return d.qy` <div class="add-target-wrapper"> <ha-generic-picker .hass="${this.hass}" .disabled="${this.disabled}" .autofocus="${this.autofocus}" .helper="${this.helper}" .sections="${e}" .notFoundLabel="${this._noTargetFoundLabel}" .emptyLabel="${this.hass.localize("ui.components.target-picker.no_targets")}" .sectionTitleFunction="${this._sectionTitleFunction}" .selectedSection="${this._selectedSection}" .rowRenderer="${this._renderRow}" .getItems="${this._getItems}" @value-changed="${this._targetPicked}" .addButtonLabel="${this.hass.localize("ui.components.target-picker.add_target")}" .getAdditionalItems="${this._getAdditionalItems}"> </ha-generic-picker> </div> `}_targetPicked(e){e.stopPropagation();const t=e.detail.value;if(t.startsWith(A))return void this._createNewDomainElement(t.substring(A.length));const[i,s]=e.detail.value.split(z);this._addTarget(s,i)}_addTarget(e,t){const i=`${t}_id`;("entity_id"!==i||(0,m.n)(e))&&(this.value&&this.value[i]&&(0,p.e)(this.value[i]).includes(e)||((0,u.r)(this,"value-changed",{value:this.value?{...this.value,[i]:this.value[i]?[...(0,p.e)(this.value[i]),e]:e}:{[i]:e}}),this.shadowRoot?.querySelector(`ha-target-picker-item-group[type='${this._newTarget?.type}']`)?.removeAttribute("collapsed")))}_handleRemove(e){const{type:t,id:i}=e.detail;(0,u.r)(this,"value-changed",{value:this._removeItem(this.value,t,i)})}_handleExpand(e){const t=e.detail.type,i=e.detail.id,s=[],a=[],r=[];if("floor"===t)Object.values(this.hass.areas).forEach(e=>{e.floor_id===i&&!this.value.area_id?.includes(e.area_id)&&(0,k.Kx)(e,this.hass.devices,this.hass.entities,this.deviceFilter,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter)&&s.push(e.area_id)});else if("area"===t)Object.values(this.hass.devices).forEach(e=>{e.area_id===i&&!this.value.device_id?.includes(e.id)&&(0,k.Ly)(e,this.hass.entities,this.deviceFilter,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter)&&a.push(e.id)}),Object.values(this.hass.entities).forEach(e=>{e.area_id===i&&!this.value.entity_id?.includes(e.entity_id)&&(0,k.YK)(e,!1,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter)&&r.push(e.entity_id)});else if("device"===t)Object.values(this.hass.entities).forEach(e=>{e.device_id===i&&!this.value.entity_id?.includes(e.entity_id)&&(0,k.YK)(e,!1,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter)&&r.push(e.entity_id)});else{if("label"!==t)return;Object.values(this.hass.areas).forEach(e=>{e.labels.includes(i)&&!this.value.area_id?.includes(e.area_id)&&(0,k.Kx)(e,this.hass.devices,this.hass.entities,this.deviceFilter,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter)&&s.push(e.area_id)}),Object.values(this.hass.devices).forEach(e=>{e.labels.includes(i)&&!this.value.device_id?.includes(e.id)&&(0,k.Ly)(e,this.hass.entities,this.deviceFilter,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter)&&a.push(e.id)}),Object.values(this.hass.entities).forEach(e=>{e.labels.includes(i)&&!this.value.entity_id?.includes(e.entity_id)&&(0,k.YK)(e,!0,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter)&&r.push(e.entity_id)})}let n=this.value;r.length&&(n=this._addItems(n,"entity_id",r)),a.length&&(n=this._addItems(n,"device_id",a)),s.length&&(n=this._addItems(n,"area_id",s)),n=this._removeItem(n,t,i),(0,u.r)(this,"value-changed",{value:n})}_addItems(e,t,i){return{...e,[t]:e[t]?(0,p.e)(e[t]).concat(i):i}}_removeItem(e,t,i){const s=`${t}_id`,a=(0,p.e)(e[s]).filter(e=>String(e)!==i);if(a.length)return{...e,[s]:a};const r={...e};return delete r[s],Object.keys(r).length?r:void 0}_filterGroup(e,t,i,s,a=!0){const r=this._fuseIndexes[e](t);return a?(0,L.x)(t,i,s,e=>e.id,r):(0,L.C)(t,i,s,r,{ignoreLocation:!0})}async _loadConfigEntries(){const e=await(0,_.VN)(this.hass);this._configEntryLookup=Object.fromEntries(e.map(e=>[e.entry_id,e]))}static get styles(){return d.AH`.add-target-wrapper{display:flex;justify-content:flex-start;margin-top:var(--ha-space-3)}ha-generic-picker{width:100%}${(0,d.iz)(n)} .items{z-index:2}.mdc-chip-set{padding:var(--ha-space-1) 0;gap:var(--ha-space-2)}.item-groups{overflow:hidden;border:2px solid var(--divider-color);border-radius:var(--ha-border-radius-lg)}`}constructor(...e){super(...e),this.compact=!1,this.disabled=!1,this.addOnTop=!1,this._configEntryLookup={},this._getDevicesMemoized=(0,h.A)(b.o),this._getLabelsMemoized=(0,h.A)(C.I),this._getEntitiesMemoized=(0,h.A)($.w),this._getAreasAndFloorsMemoized=(0,h.A)(v.bi),this._fuseIndexes={area:(0,h.A)(e=>this._createFuseIndex(e,v.Z2)),entity:(0,h.A)(e=>this._createFuseIndex(e,$.t)),device:(0,h.A)(e=>this._createFuseIndex(e,b._)),label:(0,h.A)(e=>this._createFuseIndex(e,C.u))},this._createFuseIndex=(e,t)=>o.A.createIndex(t,e),this._createNewDomainElement=e=>{(0,H.$)(this,{domain:e,dialogClosedCallback:e=>{e.entityId&&requestAnimationFrame(()=>{this._addTarget(e.entityId,"entity")})}})},this._sectionTitleFunction=({firstIndex:e,lastIndex:t,firstItem:i,secondItem:s,itemsCount:a})=>{if(void 0===i||void 0===s||"string"==typeof i||"string"==typeof s&&"padding"!==s||0===e&&t===a-1)return;const r=(0,k.OJ)(i),n="area"===r||"floor"===r?"areas":"entity"===r?"entities":r&&"empty"!==r?`${r}s`:void 0;return n?this.hass.localize(`ui.components.target-picker.type.${n}`):void 0},this._getItems=(e,t)=>(this._selectedSection=t,this._getItemsMemoized(this.hass.localize,this.entityFilter,this.deviceFilter,this.includeDomains,this.includeDeviceClasses,this.value,e,this._configEntryLookup,this._selectedSection)),this._getItemsMemoized=(0,h.A)((e,t,i,s,a,r,n,o,d)=>{const l=[];if(!d||"entity"===d){let i=this._getEntitiesMemoized(this.hass,s,void 0,t,a,void 0,void 0,r?.entity_id?(0,p.e)(r.entity_id):void 0,void 0,`entity${z}`).sort(this._sortBySortingLabel);n&&(i=this._filterGroup("entity",i,n,$.t)),!d&&i.length&&l.push(e("ui.components.target-picker.type.entities")),l.push(...i)}if(!d||"device"===d){let c=this._getDevicesMemoized(this.hass,o,s,void 0,a,i,t,r?.device_id?(0,p.e)(r.device_id):void 0,void 0,`device${z}`).sort(this._sortBySortingLabel);n&&(c=this._filterGroup("device",c,n,b._)),!d&&c.length&&l.push(e("ui.components.target-picker.type.devices")),l.push(...c)}if(!d||"area"===d){let o=this._getAreasAndFloorsMemoized(this.hass.states,this.hass.floors,this.hass.areas,this.hass.devices,this.hass.entities,(0,h.A)(e=>[e.type,e.id].join(z)),s,void 0,a,i,t,r?.area_id?(0,p.e)(r.area_id):void 0,r?.floor_id?(0,p.e)(r.floor_id):void 0);n&&(o=this._filterGroup("area",o,n,v.Z2,!1)),!d&&o.length&&l.push(e("ui.components.target-picker.type.areas")),l.push(...o.map((e,t)=>{const i=o[t+1];return!i||"area"===e.type&&"floor"===i.type?{...e,last:!0}:e}))}if(!d||"label"===d){let o=this._getLabelsMemoized(this.hass.states,this.hass.areas,this.hass.devices,this.hass.entities,this._labelRegistry,s,void 0,a,i,t,r?.label_id?(0,p.e)(r.label_id):void 0,`label${z}`).sort(this._sortBySortingLabel);n&&(o=this._filterGroup("label",o,n,C.u)),!d&&o.length&&l.push(e("ui.components.target-picker.type.labels")),l.push(...o)}return l}),this._getAdditionalItems=()=>this._getCreateItems(this.createDomains),this._getCreateItems=(0,h.A)(e=>e?.length?e.map(e=>{const t=this.hass.localize("ui.components.entity.entity-picker.create_helper",{domain:(0,M.z)(e)?this.hass.localize(`ui.panel.config.helpers.types.${e}`):(0,x.p$)(this.hass.localize,e)});return{id:A+e,primary:t,secondary:this.hass.localize("ui.components.entity.entity-picker.new_entity"),icon_path:q}}):[]),this._renderRow=(e,t)=>{if(!e)return d.s6;const i=(0,k.OJ)(e);let s=!1,a=!1,r=!1;return"area"!==i&&"floor"!==i||(a=(0,g.qC)(this.hass),s="area"===i&&!!e.area?.floor_id),"entity"===i&&(r=!!this._showEntityId),d.qy` <ha-combo-box-item id="${`list-item-${t}`}" tabindex="-1" .type="${"empty"===i?"text":"button"}" class="${"empty"===i?"empty":""}" style="${"area"===e.type&&s?"--md-list-item-leading-space: var(--ha-space-12);":""}"> ${"area"===e.type&&s?d.qy` <ha-tree-indicator style="${(0,c.W)({width:"var(--ha-space-12)",position:"absolute",top:"0",left:a?void 0:"var(--ha-space-1)",right:a?"var(--ha-space-1)":void 0,transform:a?"scaleX(-1)":""})}" .end="${e.last}" slot="start"></ha-tree-indicator> `:d.s6} ${e.icon?d.qy`<ha-icon slot="start" .icon="${e.icon}"></ha-icon>`:e.icon_path?d.qy`<ha-svg-icon slot="start" .path="${e.icon_path}"></ha-svg-icon>`:"entity"===i&&e.stateObj?d.qy` <state-badge slot="start" .stateObj="${e.stateObj}" .hass="${this.hass}"></state-badge> `:"device"===i&&e.domain?d.qy` <img slot="start" alt="" crossorigin="anonymous" referrerpolicy="no-referrer" src="${(0,V.MR)({domain:e.domain,type:"icon",darkOptimized:this.hass.themes.darkMode})}"> `:"floor"===i?d.qy`<ha-floor-icon slot="start" .floor="${e.floor}"></ha-floor-icon>`:"area"===i?d.qy`<ha-svg-icon slot="start" .path="${e.icon_path||E}"></ha-svg-icon>`:d.s6} <span slot="headline">${e.primary}</span> ${e.secondary?d.qy`<span slot="supporting-text">${e.secondary}</span>`:d.s6} ${e.stateObj&&r?d.qy` <span slot="supporting-text" class="code"> ${e.stateObj?.entity_id} </span> `:d.s6} ${!e.domain_name||"entity"===i&&r?d.s6:d.qy` <div slot="trailing-supporting-text" class="domain"> ${e.domain_name} </div> `} </ha-combo-box-item> `},this._noTargetFoundLabel=e=>this.hass.localize("ui.components.target-picker.no_target_found",{term:d.qy`<b>‘${e}’</b>`}),this._sortBySortingLabel=(e,t)=>(0,y.SH)(e.sorting_label,t.sorting_label,this.hass?.locale.language??navigator.language)}}(0,s.Cg)([(0,l.MZ)({attribute:!1})],j.prototype,"hass",void 0),(0,s.Cg)([(0,l.MZ)({attribute:!1})],j.prototype,"value",void 0),(0,s.Cg)([(0,l.MZ)()],j.prototype,"helper",void 0),(0,s.Cg)([(0,l.MZ)({type:Boolean,reflect:!0})],j.prototype,"compact",void 0),(0,s.Cg)([(0,l.MZ)({attribute:!1,type:Array})],j.prototype,"createDomains",void 0),(0,s.Cg)([(0,l.MZ)({type:Array,attribute:"include-domains"})],j.prototype,"includeDomains",void 0),(0,s.Cg)([(0,l.MZ)({type:Array,attribute:"include-device-classes"})],j.prototype,"includeDeviceClasses",void 0),(0,s.Cg)([(0,l.MZ)({attribute:!1})],j.prototype,"deviceFilter",void 0),(0,s.Cg)([(0,l.MZ)({attribute:!1})],j.prototype,"entityFilter",void 0),(0,s.Cg)([(0,l.MZ)({type:Boolean,reflect:!0})],j.prototype,"disabled",void 0),(0,s.Cg)([(0,l.MZ)({attribute:"add-on-top",type:Boolean})],j.prototype,"addOnTop",void 0),(0,s.Cg)([(0,l.wk)()],j.prototype,"_selectedSection",void 0),(0,s.Cg)([(0,l.wk)()],j.prototype,"_configEntryLookup",void 0),(0,s.Cg)([(0,l.wk)(),(0,r.Fg)({context:f.HD,subscribe:!0})],j.prototype,"_labelRegistry",void 0),j=(0,s.Cg)([(0,l.EM)("ha-target-picker")],j),t()}catch(e){t(e)}})},34127(e,t,i){i.a(e,async function(e,t){try{var s=i(62826),a=i(52630),r=i(96196),n=i(77845),o=e([a]);a=(o.then?(await o)():o)[0];class d extends a.A{static get styles(){return[a.A.styles,r.AH`:host{--wa-tooltip-background-color:var(--secondary-background-color);--wa-tooltip-content-color:var(--primary-text-color);--wa-tooltip-font-family:var(
            --ha-tooltip-font-family,
            var(--ha-font-family-body)
          );--wa-tooltip-font-size:var(
            --ha-tooltip-font-size,
            var(--ha-font-size-s)
          );--wa-tooltip-font-weight:var(
            --ha-tooltip-font-weight,
            var(--ha-font-weight-normal)
          );--wa-tooltip-line-height:var(
            --ha-tooltip-line-height,
            var(--ha-line-height-condensed)
          );--wa-tooltip-padding:8px;--wa-tooltip-border-radius:var(
            --ha-tooltip-border-radius,
            var(--ha-border-radius-sm)
          );--wa-tooltip-arrow-size:var(--ha-tooltip-arrow-size, 8px);--wa-z-index-tooltip:var(--ha-tooltip-z-index, 1000)}`]}constructor(...e){super(...e),this.showDelay=150,this.hideDelay=150}}(0,s.Cg)([(0,n.MZ)({attribute:"show-delay",type:Number})],d.prototype,"showDelay",void 0),(0,s.Cg)([(0,n.MZ)({attribute:"hide-delay",type:Number})],d.prototype,"hideDelay",void 0),d=(0,s.Cg)([(0,n.EM)("ha-tooltip")],d),t()}catch(e){t(e)}})},73150(e,t,i){var s=i(62826),a=i(96196),r=i(77845);class n extends a.WF{render(){return a.qy` <svg width="100%" height="100%" viewBox="0 0 48 48"> <line x1="24" y1="0" x2="24" y2="${this.end?"24":"48"}"></line> <line x1="24" y1="24" x2="36" y2="24"></line> </svg> `}constructor(...e){super(...e),this.end=!1}}n.styles=a.AH`:host{display:block;width:48px;height:48px}line{stroke:var(--divider-color);stroke-width:2;stroke-dasharray:2}`,(0,s.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],n.prototype,"end",void 0),n=(0,s.Cg)([(0,r.EM)("ha-tree-indicator")],n)},89081(e,t,i){i.d(t,{D:()=>r});var s=i(1087);const a=()=>i.e("7704").then(i.bind(i,25563)),r=(e,t)=>(0,s.r)(e,"show-dialog",{dialogTag:"ha-dialog-target-details",dialogImport:a,dialogParams:t})},22099(e,t,i){i.a(e,async function(e,t){try{i(18111),i(7588),i(61701);var s=i(62826),a=i(96196),r=i(77845),n=(i(11382),i(17308),i(92288)),o=e([n]);n=(o.then?(await o)():o)[0];class d extends a.WF{render(){let e=0;return Object.values(this.items).forEach(t=>{t&&(e+=t.length)}),a.qy`<ha-expansion-panel .expanded="${!this.collapsed}" left-chevron @expanded-changed="${this._expandedChanged}"> <div slot="header" class="heading"> ${this.hass.localize(`ui.components.target-picker.selected.${this.type}`,{count:e})} </div> ${Object.entries(this.items).map(([e,t])=>t?t.map(t=>a.qy`<ha-target-picker-item-row .hass="${this.hass}" .type="${e}" .itemId="${t}" .deviceFilter="${this.deviceFilter}" .entityFilter="${this.entityFilter}" .includeDomains="${this.includeDomains}" .includeDeviceClasses="${this.includeDeviceClasses}"></ha-target-picker-item-row>`):a.s6)} </ha-expansion-panel>`}_expandedChanged(e){this.collapsed=!e.detail.expanded}constructor(...e){super(...e),this.collapsed=!1}}d.styles=a.AH`:host{display:block;--expansion-panel-content-padding:0}ha-expansion-panel::part(summary){background-color:var(--ha-color-fill-neutral-quiet-resting);padding:var(--ha-space-1) var(--ha-space-2);font-weight:var(--ha-font-weight-bold);color:var(--secondary-text-color);display:flex;justify-content:space-between;min-height:unset}ha-md-list{padding:0}`,(0,s.Cg)([(0,r.MZ)({attribute:!1})],d.prototype,"hass",void 0),(0,s.Cg)([(0,r.MZ)()],d.prototype,"type",void 0),(0,s.Cg)([(0,r.MZ)({attribute:!1})],d.prototype,"items",void 0),(0,s.Cg)([(0,r.MZ)({type:Boolean,reflect:!0})],d.prototype,"collapsed",void 0),(0,s.Cg)([(0,r.MZ)({attribute:!1})],d.prototype,"deviceFilter",void 0),(0,s.Cg)([(0,r.MZ)({attribute:!1})],d.prototype,"entityFilter",void 0),(0,s.Cg)([(0,r.MZ)({type:Array,attribute:"include-domains"})],d.prototype,"includeDomains",void 0),(0,s.Cg)([(0,r.MZ)({type:Array,attribute:"include-device-classes"})],d.prototype,"includeDeviceClasses",void 0),d=(0,s.Cg)([(0,r.EM)("ha-target-picker-item-group")],d),t()}catch(e){t(e)}})},92288(e,t,i){i.a(e,async function(e,t){try{i(44114),i(18111),i(22489),i(20116),i(61701),i(13579);var s=i(62826),a=i(16527),r=i(96196),n=i(77845),o=i(22786),d=i(1087),l=i(65522),c=i(79),h=i(71727),p=i(4358),u=i(28455),m=i(15638),y=i(77423),g=i(38911),v=i(95350),_=i(88555),f=i(14503),b=i(44144),$=i(18198),x=(i(50888),i(17308),i(2846),i(93367)),C=(i(67094),i(89081)),k=e([x]);x=(k.then?(await k)():k)[0];const w="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",M="M3 6H21V4H3C1.9 4 1 4.9 1 6V18C1 19.1 1.9 20 3 20H7V18H3V6M13 12H9V13.78C8.39 14.33 8 15.11 8 16C8 16.89 8.39 17.67 9 18.22V20H13V18.22C13.61 17.67 14 16.88 14 16S13.61 14.33 13 13.78V12M11 17.5C10.17 17.5 9.5 16.83 9.5 16S10.17 14.5 11 14.5 12.5 15.17 12.5 16 11.83 17.5 11 17.5M22 8H16C15.5 8 15 8.5 15 9V19C15 19.5 15.5 20 16 20H22C22.5 20 23 19.5 23 19V9C23 8.5 22.5 8 22 8M21 18H17V10H21V18Z",H="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z",L="M17.63,5.84C17.27,5.33 16.67,5 16,5H5A2,2 0 0,0 3,7V17A2,2 0 0,0 5,19H16C16.67,19 17.27,18.66 17.63,18.15L22,12L17.63,5.84Z",V="M20 2H4C2.9 2 2 2.9 2 4V20C2 21.11 2.9 22 4 22H20C21.11 22 22 21.11 22 20V4C22 2.9 21.11 2 20 2M4 6L6 4H10.9L4 10.9V6M4 13.7L13.7 4H18.6L4 18.6V13.7M20 18L18 20H13.1L20 13.1V18M20 10.3L10.3 20H5.4L20 5.4V10.3Z";class I extends r.WF{willUpdate(e){!this.subEntry&&e.has("itemId")&&this._updateItemData()}render(){const{name:e,context:t,iconPath:i,fallbackIconPath:s,stateObject:a,notFound:n}=this._itemData(this.type,this.itemId),o="entity"!==this.type&&!n,d=this.parentEntries||this._entries;return!this.subEntry||"entity"===this.type||d&&0!==d.referenced_entities.length?r.qy` <ha-md-list-item type="text" class="${n?"error":""}"> <div class="icon" slot="start"> ${this.subEntry?r.qy` <div class="horizontal-line-wrapper"> <div class="horizontal-line"></div> </div> `:r.s6} ${i?r.qy`<ha-icon .icon="${i}"></ha-icon>`:this._iconImg?r.qy`<img alt="${this._domainName||""}" crossorigin="anonymous" referrerpolicy="no-referrer" src="${this._iconImg}">`:s?r.qy`<ha-svg-icon .path="${s}"></ha-svg-icon>`:"entity"===this.type?r.qy` <ha-state-icon .hass="${this.hass}" .stateObj="${a||{entity_id:this.itemId,attributes:{}}}"> </ha-state-icon> `:r.s6} </div> <div slot="headline">${e}</div> ${n||t&&!this.hideContext?r.qy`<span slot="supporting-text">${n?this.hass.localize(`ui.components.target-picker.${this.type}_not_found`):t}</span>`:r.s6} ${this._domainName&&this.subEntry?r.qy`<span slot="supporting-text" class="domain">${this._domainName}</span>`:r.s6} ${!this.subEntry&&d&&o?r.qy` <div slot="end" class="summary"> ${o&&!this.expand&&d?.referenced_entities.length?r.qy`<button class="main link" @click="${this._openDetails}"> ${this.hass.localize("ui.components.target-picker.entities_count",{count:d?.referenced_entities.length})} </button>`:o?r.qy`<span class="main"> ${this.hass.localize("ui.components.target-picker.entities_count",{count:d?.referenced_entities.length})} </span>`:r.s6} </div> `:r.s6} ${this.expand||this.subEntry?r.s6:r.qy` <ha-icon-button .path="${w}" slot="end" @click="${this._removeItem}"></ha-icon-button> `} </ha-md-list-item> ${this.expand&&d&&d.referenced_entities?this._renderEntries():r.s6} `:r.s6}_renderEntries(){const e=this.parentEntries||this._entries;let t="floor"===this.type?"area":"area"===this.type?"device":"entity";"label"===this.type&&(e?.referenced_areas.length?t="area":e?.referenced_devices.length&&(t="device"));const i=("area"===t?e?.referenced_areas:"device"===t&&"label"!==this.type?e?.referenced_devices:"label"!==this.type?e?.referenced_entities:[])||[],s=[],a="entity"===t?void 0:i.map(i=>{const a={referenced_areas:[],referenced_devices:[],referenced_entities:[]};return"area"===t?(a.referenced_devices=e?.referenced_devices.filter(t=>this.hass.devices?.[t]?.area_id===i&&e?.referenced_entities.some(e=>this.hass.entities?.[e]?.device_id===t))||[],s.push(...a.referenced_devices),a.referenced_entities=e?.referenced_entities.filter(e=>{const t=this.hass.entities[e];return t.area_id===i||!t.device_id||a.referenced_devices.includes(t.device_id)})||[],a):(a.referenced_entities=e?.referenced_entities.filter(e=>this.hass.entities?.[e]?.device_id===i)||[],a)}),n="label"===this.type&&e?e.referenced_entities.filter(t=>{const i=this.hass.entities[t];return i.labels.includes(this.itemId)&&!e.referenced_devices.includes(i.device_id||"")}):"device"===t&&e?e.referenced_entities.filter(e=>this.hass.entities[e].area_id===this.itemId):[],o="label"===this.type&&e?e.referenced_devices.filter(e=>!s.includes(e)&&this.hass.devices[e].labels.includes(this.itemId)):[],d=0===o.length?void 0:o.map(t=>({referenced_areas:[],referenced_devices:[],referenced_entities:e?.referenced_entities.filter(e=>this.hass.entities?.[e]?.device_id===t)||[]}));return r.qy` <div class="entries-tree"> <div class="line-wrapper"> <div class="line"></div> </div> <ha-md-list class="entries"> ${i.map((e,i)=>r.qy` <ha-target-picker-item-row sub-entry .hass="${this.hass}" .type="${t}" .itemId="${e}" .parentEntries="${a?.[i]}" .hideContext="${this.hideContext||"label"!==this.type}" expand></ha-target-picker-item-row> `)} ${o.map((e,t)=>r.qy` <ha-target-picker-item-row sub-entry .hass="${this.hass}" type="device" .itemId="${e}" .parentEntries="${d?.[t]}" .hideContext="${this.hideContext||"label"!==this.type}" expand></ha-target-picker-item-row> `)} ${n.map(e=>r.qy` <ha-target-picker-item-row sub-entry .hass="${this.hass}" type="entity" .itemId="${e}" .hideContext="${this.hideContext||"label"!==this.type}"></ha-target-picker-item-row> `)} </ha-md-list> </div> `}async _updateItemData(){if("entity"!==this.type)try{const e=await(0,_.F7)(this.hass,{[`${this.type}_id`]:[this.itemId]}),t=[];"floor"!==this.type&&"label"!==this.type||(e.referenced_areas=e.referenced_areas.filter(e=>{const i=this.hass.areas[e];return!("floor"!==this.type&&!i.labels.includes(this.itemId)||!(0,_.Kx)(i,this.hass.devices,this.hass.entities,this.deviceFilter,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter))||(t.push(e),!1)}));const i=[];"floor"!==this.type&&"area"!==this.type&&"label"!==this.type||(e.referenced_devices=e.referenced_devices.filter(e=>{const s=this.hass.devices[e];return!(t.includes(s.area_id||"")||!(0,_.Ly)(s,this.hass.entities,this.deviceFilter,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter))||(i.push(e),!1)})),e.referenced_entities=e.referenced_entities.filter(t=>{const s=this.hass.entities[t];return!i.includes(s.device_id||"")&&(!!("area"===this.type&&s.area_id===this.itemId||"floor"===this.type&&s.area_id&&e.referenced_areas.includes(s.area_id)||"label"===this.type&&s.labels.includes(this.itemId)||e.referenced_devices.includes(s.device_id||""))&&(0,_.YK)(s,"label"===this.type,this.includeDomains,this.includeDeviceClasses,this.hass.states,this.entityFilter))}),this._entries=e}catch(e){console.error("Failed to extract target",e)}else this._entries=void 0}_setDomainName(e){this._domainName=(0,v.p$)(this.hass.localize,e)}_removeItem(e){e.stopPropagation(),(0,d.r)(this,"remove-target-item",{type:this.type,id:this.itemId})}async _getDeviceDomain(e){try{const t=(await(0,y.Vx)(this.hass,e)).config_entry.domain;this._iconImg=(0,b.MR)({domain:t,type:"icon",darkOptimized:this.hass.themes?.darkMode}),this._setDomainName(t)}catch{}}_openDetails(){(0,C.D)(this,{title:this._itemData(this.type,this.itemId).name,type:this.type,itemId:this.itemId,deviceFilter:this.deviceFilter,entityFilter:this.entityFilter,includeDomains:this.includeDomains,includeDeviceClasses:this.includeDeviceClasses})}constructor(...e){super(...e),this.expand=!1,this.subEntry=!1,this.hideContext=!1,this._itemData=(0,o.A)((e,t)=>{if("floor"===e){const e=this.hass.floors?.[t];return{name:e?.name||t,iconPath:e?.icon,fallbackIconPath:e?(0,$.Si)(e):H,notFound:!e}}if("area"===e){const e=this.hass.areas?.[t];return{name:e?.name||t,context:e?.floor_id&&this.hass.floors?.[e.floor_id]?.name,iconPath:e?.icon,fallbackIconPath:V,notFound:!e}}if("device"===e){const e=this.hass.devices?.[t];return e?.primary_config_entry&&this._getDeviceDomain(e.primary_config_entry),{name:e?(0,c.T)(e,this.hass):t,context:e?.area_id&&this.hass.areas?.[e.area_id]?.name,fallbackIconPath:M,notFound:!e}}if("entity"===e){this._setDomainName((0,h.m)(t));const e=this.hass.states[t],i=e?(0,p.aH)(e,this.hass.entities,this.hass.devices):t,{area:s,device:a}=e?(0,u.l)(e,this.hass.entities,this.hass.devices,this.hass.areas,this.hass.floors):{area:void 0,device:void 0},r=a?(0,c.xn)(a):void 0,n=[s?(0,l.A)(s):void 0,i?r:void 0].filter(Boolean).join((0,m.qC)(this.hass)?" ◂ ":" ▸ ");return{name:i||r||t,context:n,stateObject:e,notFound:!e&&"all"!==t&&"none"!==t}}const i=this._labelRegistry.find(e=>e.label_id===t);return{name:i?.name||t,iconPath:i?.icon,fallbackIconPath:L,notFound:!i}})}}I.styles=[f.og,r.AH`:host{--md-list-item-top-space:0;--md-list-item-bottom-space:0;--md-list-item-leading-space:var(--ha-space-2);--md-list-item-trailing-space:var(--ha-space-2);--md-list-item-two-line-container-height:56px}:host([expand]:not([sub-entry])) ha-md-list-item{border:2px solid var(--ha-color-border-neutral-loud);background-color:var(--ha-color-fill-neutral-quiet-resting);border-radius:var(--ha-card-border-radius,var(--ha-border-radius-lg))}.error{background:var(--ha-color-fill-warning-quiet-resting)}.error [slot=supporting-text]{color:var(--ha-color-on-warning-normal)}state-badge{color:var(--ha-color-on-neutral-quiet)}.icon{width:24px;display:flex}img{width:24px;height:24px;z-index:1}ha-icon-button{--mdc-icon-button-size:32px}.summary{display:flex;flex-direction:column;align-items:flex-end;line-height:var(--ha-line-height-condensed)}:host([sub-entry]) .summary{margin-right:var(--ha-space-12)}.summary .main{font-weight:var(--ha-font-weight-medium)}.summary .secondary{font-size:var(--ha-font-size-s);color:var(--secondary-text-color)}.entries-tree{display:flex;position:relative}.entries-tree .line-wrapper{padding:var(--ha-space-5)}.entries-tree .line-wrapper .line{border-left:2px dashed var(--divider-color);height:calc(100% - 28px);position:absolute;top:0}:host([sub-entry]) .entries-tree .line-wrapper .line{height:calc(100% - 12px);top:-18px}.entries{padding:0;--md-item-overflow:visible}.horizontal-line-wrapper{position:relative}.horizontal-line-wrapper .horizontal-line{position:absolute;top:11px;margin-inline-start:-28px;width:29px;border-top:2px dashed var(--divider-color)}button.link{text-decoration:none;color:var(--primary-color)}button.link:focus,button.link:hover{text-decoration:underline}.domain{width:fit-content;border-radius:var(--ha-border-radius-md);background-color:var(--ha-color-fill-neutral-quiet-resting);padding:var(--ha-space-1);font-family:var(--ha-font-family-code)}`],(0,s.Cg)([(0,n.MZ)({attribute:!1})],I.prototype,"hass",void 0),(0,s.Cg)([(0,n.MZ)({reflect:!0})],I.prototype,"type",void 0),(0,s.Cg)([(0,n.MZ)({attribute:"item-id"})],I.prototype,"itemId",void 0),(0,s.Cg)([(0,n.MZ)({type:Boolean})],I.prototype,"expand",void 0),(0,s.Cg)([(0,n.MZ)({type:Boolean,attribute:"sub-entry",reflect:!0})],I.prototype,"subEntry",void 0),(0,s.Cg)([(0,n.MZ)({type:Boolean,attribute:"hide-context"})],I.prototype,"hideContext",void 0),(0,s.Cg)([(0,n.MZ)({attribute:!1})],I.prototype,"parentEntries",void 0),(0,s.Cg)([(0,n.MZ)({attribute:!1})],I.prototype,"deviceFilter",void 0),(0,s.Cg)([(0,n.MZ)({attribute:!1})],I.prototype,"entityFilter",void 0),(0,s.Cg)([(0,n.MZ)({type:Array,attribute:"include-domains"})],I.prototype,"includeDomains",void 0),(0,s.Cg)([(0,n.MZ)({type:Array,attribute:"include-device-classes"})],I.prototype,"includeDeviceClasses",void 0),(0,s.Cg)([(0,n.wk)()],I.prototype,"_iconImg",void 0),(0,s.Cg)([(0,n.wk)()],I.prototype,"_domainName",void 0),(0,s.Cg)([(0,n.wk)()],I.prototype,"_entries",void 0),(0,s.Cg)([(0,n.wk)(),(0,a.Fg)({context:g.HD,subscribe:!0})],I.prototype,"_labelRegistry",void 0),(0,s.Cg)([(0,n.P)("ha-md-list-item")],I.prototype,"item",void 0),(0,s.Cg)([(0,n.P)("ha-md-list")],I.prototype,"list",void 0),(0,s.Cg)([(0,n.P)("ha-target-picker-item-row")],I.prototype,"itemRow",void 0),I=(0,s.Cg)([(0,n.EM)("ha-target-picker-item-row")],I),t()}catch(e){t(e)}})},69404(e,t,i){i.a(e,async function(e,t){try{i(18111),i(20116);var s=i(62826),a=i(16527),r=i(94454),n=i(96196),o=i(77845),d=i(94333),l=i(22786),c=i(78870),h=i(49485),p=i(1087),u=i(79),m=i(71727),y=i(28978),g=i(80880),v=i(77423),_=i(38911),f=i(95350),b=i(44144),$=i(18198),x=(i(50888),i(17308),i(2846),i(93367)),C=i(34127),k=e([x,C]);[x,C]=k.then?(await k)():k;const w="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",M="M3 6H21V4H3C1.9 4 1 4.9 1 6V18C1 19.1 1.9 20 3 20H7V18H3V6M13 12H9V13.78C8.39 14.33 8 15.11 8 16C8 16.89 8.39 17.67 9 18.22V20H13V18.22C13.61 17.67 14 16.88 14 16S13.61 14.33 13 13.78V12M11 17.5C10.17 17.5 9.5 16.83 9.5 16S10.17 14.5 11 14.5 12.5 15.17 12.5 16 11.83 17.5 11 17.5M22 8H16C15.5 8 15 8.5 15 9V19C15 19.5 15.5 20 16 20H22C22.5 20 23 19.5 23 19V9C23 8.5 22.5 8 22 8M21 18H17V10H21V18Z",H="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z",L="M17.63,5.84C17.27,5.33 16.67,5 16,5H5A2,2 0 0,0 3,7V17A2,2 0 0,0 5,19H16C16.67,19 17.27,18.66 17.63,18.15L22,12L17.63,5.84Z",V="M20 2H4C2.9 2 2 2.9 2 4V20C2 21.11 2.9 22 4 22H20C21.11 22 22 21.11 22 20V4C22 2.9 21.11 2 20 2M4 6L6 4H10.9L4 10.9V6M4 13.7L13.7 4H18.6L4 18.6V13.7M20 18L18 20H13.1L20 13.1V18M20 10.3L10.3 20H5.4L20 5.4V10.3Z",I="M18.17,12L15,8.83L16.41,7.41L21,12L16.41,16.58L15,15.17L18.17,12M5.83,12L9,15.17L7.59,16.59L3,12L7.59,7.42L9,8.83L5.83,12Z";class D extends n.WF{render(){const{name:e,iconPath:t,fallbackIconPath:i,stateObject:s,color:a}=this._itemData(this.type,this.itemId);return n.qy` <div class="mdc-chip ${(0,d.H)({[this.type]:!0})}" style="${a?`--color: rgb(${a}); --background-color: rgba(${a}, .5)`:""}"> ${t?n.qy`<ha-icon class="mdc-chip__icon mdc-chip__icon--leading" .icon="${t}"></ha-icon>`:this._iconImg?n.qy`<img class="mdc-chip__icon mdc-chip__icon--leading" alt="${this._domainName||""}" crossorigin="anonymous" referrerpolicy="no-referrer" src="${this._iconImg}">`:i?n.qy`<ha-svg-icon class="mdc-chip__icon mdc-chip__icon--leading" .path="${i}"></ha-svg-icon>`:s?n.qy`<ha-state-icon class="mdc-chip__icon mdc-chip__icon--leading" .hass="${this.hass}" .stateObj="${s}"></ha-state-icon>`:n.s6} <span role="gridcell"> <span role="button" tabindex="0" class="mdc-chip__primary-action"> <span id="title-${this.itemId}" class="mdc-chip__text">${e}</span> </span> </span> ${"entity"===this.type?n.s6:n.qy`<span role="gridcell"> <ha-tooltip .for="expand-${(0,g.Y)(this.itemId)}">${this.hass.localize(`ui.components.target-picker.expand_${this.type}_id`)} </ha-tooltip> <ha-icon-button class="expand-btn mdc-chip__icon mdc-chip__icon--trailing" .label="${this.hass.localize("ui.components.target-picker.expand")}" .path="${I}" hide-title .id="expand-${(0,g.Y)(this.itemId)}" .type="${this.type}" @click="${this._handleExpand}"></ha-icon-button> </span>`} <span role="gridcell"> <ha-tooltip .for="remove-${(0,g.Y)(this.itemId)}"> ${this.hass.localize(`ui.components.target-picker.remove_${this.type}_id`)} </ha-tooltip> <ha-icon-button class="mdc-chip__icon mdc-chip__icon--trailing" .label="${this.hass.localize("ui.components.target-picker.remove")}" .path="${w}" hide-title .id="remove-${(0,g.Y)(this.itemId)}" .type="${this.type}" @click="${this._removeItem}"></ha-icon-button> </span> </div> `}_setDomainName(e){this._domainName=(0,f.p$)(this.hass.localize,e)}async _getDeviceDomain(e){try{const t=(await(0,v.Vx)(this.hass,e)).config_entry.domain;this._iconImg=(0,b.MR)({domain:t,type:"icon",darkOptimized:this.hass.themes?.darkMode}),this._setDomainName(t)}catch{}}_removeItem(e){e.stopPropagation(),(0,p.r)(this,"remove-target-item",{type:this.type,id:this.itemId})}_handleExpand(e){e.stopPropagation(),(0,p.r)(this,"expand-target-item",{type:this.type,id:this.itemId})}constructor(...e){super(...e),this._itemData=(0,l.A)((e,t)=>{if("floor"===e){const e=this.hass.floors?.[t];return{name:e?.name||t,iconPath:e?.icon,fallbackIconPath:e?(0,$.Si)(e):H}}if("area"===e){const e=this.hass.areas?.[t];return{name:e?.name||t,iconPath:e?.icon,fallbackIconPath:V}}if("device"===e){const e=this.hass.devices?.[t];return e.primary_config_entry&&this._getDeviceDomain(e.primary_config_entry),{name:e?(0,u.T)(e,this.hass):t,fallbackIconPath:M}}if("entity"===e){this._setDomainName((0,m.m)(t));const e=this.hass.states[t];return{name:(0,y.u)(e)||t,stateObject:e}}const i=this._labelRegistry.find(e=>e.label_id===t);let s=i?.color?(0,c.M)(i.color):void 0;if(s?.startsWith("var(")){s=getComputedStyle(this).getPropertyValue(s.substring(4,s.length-1))}return s?.startsWith("#")&&(s=(0,h.xp)(s).join(",")),{name:i?.name||t,iconPath:i?.icon,fallbackIconPath:L,color:s}})}}D.styles=n.AH`${(0,n.iz)(r)} .mdc-chip{color:var(--primary-text-color)}.mdc-chip.add{color:rgba(0,0,0,.87)}.add-container{position:relative;display:inline-flex}.mdc-chip:not(.add){cursor:default}.mdc-chip ha-icon-button{--mdc-icon-button-size:24px;display:flex;align-items:center;outline:0}.mdc-chip ha-icon-button ha-svg-icon{border-radius:50%;background:var(--secondary-text-color)}.mdc-chip__icon.mdc-chip__icon--trailing{width:var(--ha-space-4);height:var(--ha-space-4);--mdc-icon-size:14px;color:var(--secondary-text-color);margin-inline-start:var(--ha-space-1)!important;margin-inline-end:calc(-1 * var(--ha-space-1))!important;direction:var(--direction)}.mdc-chip__icon--leading{display:flex;align-items:center;justify-content:center;--mdc-icon-size:20px;border-radius:var(--ha-border-radius-circle);padding:6px;margin-left:-13px!important;margin-inline-start:-13px!important;margin-inline-end:var(--ha-space-1)!important;direction:var(--direction)}.expand-btn{margin-right:0;margin-inline-end:0;margin-inline-start:initial}.mdc-chip.area:not(.add),.mdc-chip.floor:not(.add){border:1px solid #fed6a4;background:var(--card-background-color)}.mdc-chip.area.add,.mdc-chip.area:not(.add) .mdc-chip__icon--leading,.mdc-chip.floor.add,.mdc-chip.floor:not(.add) .mdc-chip__icon--leading{background:#fed6a4}.mdc-chip.device:not(.add){border:1px solid #a8e1fb;background:var(--card-background-color)}.mdc-chip.device.add,.mdc-chip.device:not(.add) .mdc-chip__icon--leading{background:#a8e1fb}.mdc-chip.entity:not(.add){border:1px solid #d2e7b9;background:var(--card-background-color)}.mdc-chip.entity.add,.mdc-chip.entity:not(.add) .mdc-chip__icon--leading{background:#d2e7b9}.mdc-chip.label:not(.add){border:1px solid var(--color,#e0e0e0);background:var(--card-background-color)}.mdc-chip.label.add,.mdc-chip.label:not(.add) .mdc-chip__icon--leading{background:var(--background-color,#e0e0e0)}.mdc-chip:hover{z-index:5}:host([disabled]) .mdc-chip{opacity:var(--light-disabled-opacity);pointer-events:none}.tooltip-icon-img{width:24px;height:24px}`,(0,s.Cg)([(0,o.MZ)({attribute:!1})],D.prototype,"hass",void 0),(0,s.Cg)([(0,o.MZ)()],D.prototype,"type",void 0),(0,s.Cg)([(0,o.MZ)({attribute:"item-id"})],D.prototype,"itemId",void 0),(0,s.Cg)([(0,o.wk)()],D.prototype,"_domainName",void 0),(0,s.Cg)([(0,o.wk)()],D.prototype,"_iconImg",void 0),(0,s.Cg)([(0,o.wk)(),(0,a.Fg)({context:_.HD,subscribe:!0})],D.prototype,"_labelRegistry",void 0),D=(0,s.Cg)([(0,o.EM)("ha-target-picker-value-chip")],D),t()}catch(e){t(e)}})},76952(e,t,i){i.d(t,{bi:()=>d,g3:()=>o,Z2:()=>l});i(44114),i(18111),i(81148),i(22489),i(7588),i(61701),i(13579),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698);var s=i(65522),a=i(71727),r=i(55931),n=i(44927);const o=(e,t,i,s,a,r,n,o,d,l,h,p,u)=>c(e,t,i,s,a,r,n,o,d,l,h,p,u,!0),d=(e,t,i,s,a,r,n,o,d,l,h,p,u)=>c(e,t,i,s,a,r,n,o,d,l,h,p,u),l=[{name:"search_labels.name",weight:10},{name:"search_labels.aliases",weight:8},{name:"search_labels.floorName",weight:6},{name:"search_labels.relatedAreas",weight:4},{name:"search_labels.id",weight:3}],c=(e,t,i,o,d,l,c,h,p,u,m,y,g,v=!1)=>{const _=Object.values(t),f=Object.values(i),b=Object.values(o),$=Object.values(d);let x,C,k={};(c||h||p||u||m)&&(k=(0,n.g2)($),x=b,C=$.filter(e=>e.area_id),c&&(x=x.filter(e=>{const t=k[e.id];return!(!t||!t.length)&&k[e.id].some(e=>c.includes((0,a.m)(e.entity_id)))}),C=C.filter(e=>c.includes((0,a.m)(e.entity_id)))),h&&(x=x.filter(e=>{const t=k[e.id];return!t||!t.length||$.every(e=>!h.includes((0,a.m)(e.entity_id)))}),C=C.filter(e=>!h.includes((0,a.m)(e.entity_id)))),p&&(x=x.filter(t=>{const i=k[t.id];return!(!i||!i.length)&&k[t.id].some(t=>{const i=e[t.entity_id];return!!i&&(i.attributes.device_class&&p.includes(i.attributes.device_class))})}),C=C.filter(t=>{const i=e[t.entity_id];return i.attributes.device_class&&p.includes(i.attributes.device_class)})),u&&(x=x.filter(e=>u(e))),m&&(x=x.filter(t=>{const i=k[t.id];return!(!i||!i.length)&&k[t.id].some(t=>{const i=e[t.entity_id];return!!i&&m(i)})}),C=C.filter(t=>{const i=e[t.entity_id];return!!i&&m(i)})));let w,M=f,H=_;if(x&&(w=x.filter(e=>e.area_id).map(e=>e.area_id)),C&&(w=(w??[]).concat(C.filter(e=>e.area_id).map(e=>e.area_id))),w&&(M=M.filter(e=>w.includes(e.area_id))),y&&(M=M.filter(e=>!y.includes(e.area_id))),g&&(M=M.filter(e=>!e.floor_id||!g.includes(e.floor_id)),H=H.filter(e=>!g.includes(e.floor_id))),m||u||c||h||p){const e=new Set(M.map(e=>e.floor_id).filter(e=>e));H=H.filter(t=>e.has(t.floor_id))}const L=((e,t)=>{const i=new Map,s=[];for(const e of t)e.floor_id?(i.has(e.floor_id)||i.set(e.floor_id,[]),i.get(e.floor_id).push(e.area_id)):s.push(e.area_id);return{floors:e.map(e=>({id:e.floor_id,areas:i.get(e.floor_id)||[]})),areas:s}})(H,M),V=[];L.floors.forEach(e=>{const a=t[e.id],n=e.areas.map(e=>i[e]),o=(0,r.X)(a),d=n.map(e=>{const t=(0,s.A)(e);return[e.area_id,...t?[t]:[],...e.aliases]}).flat(),c={id:l({id:a.floor_id,type:"floor"}),type:"floor",primary:o,floor:a,icon:a.icon||void 0,search_labels:{id:a.floor_id,name:o||null,aliases:a.aliases.join(", ")||null,relatedAreas:d.join(" ")||null}};V.push(c);const h=n.map(e=>{const t=(0,s.A)(e);return{id:l({id:e.area_id,type:"area"}),type:"area",primary:t||e.area_id,area:e,icon:e.icon||void 0,search_labels:{id:e.area_id,name:t||null,aliases:e.aliases.join(", ")||null,floorName:o||null}}});v&&a?c.areas=h:V.push(...h)});const I=L.areas.map(e=>{const t=i[e],a=(0,s.A)(t);return{id:l({id:t.area_id,type:"area"}),type:"area",primary:a||t.area_id,area:t,icon:t.icon||void 0,search_labels:{id:t.area_id,name:a||null,aliases:t.aliases.join(", ")||null}}});return v&&I.length?V.push({id:void 0,areas:I}):V.push(...I),V}},77423(e,t,i){i.d(t,{VN:()=>a,Vx:()=>r,t0:()=>s});i(44114),i(18111),i(22489),i(20116),i(7588),i(61701);const s=(e,t)=>e.callWS({type:"config_entries/subentries/list",entry_id:t}),a=(e,t)=>{const i={};return t&&(t.type&&(i.type_filter=t.type),t.domain&&(i.domain=t.domain)),e.callWS({type:"config_entries/get",...i})},r=(e,t)=>e.callWS({type:"config_entries/get_single",entry_id:t})},31422(e,t,i){i.d(t,{_:()=>l,o:()=>c});i(18111),i(81148),i(22489),i(61701),i(13579);var s=i(65522),a=i(79),r=i(71727),n=i(76774),o=i(95350),d=i(44927);const l=[{name:"search_labels.deviceName",weight:10},{name:"search_labels.areaName",weight:8},{name:"search_labels.domainName",weight:4},{name:"search_labels.domain",weight:4}],c=(e,t,i,l,c,h,p,u,m,y="")=>{const g=Object.values(e.devices),v=Object.values(e.entities);let _={};(i||l||c||p)&&(_=(0,d.g2)(v));let f=g.filter(e=>e.id===m||!e.disabled_by);i&&(f=f.filter(e=>{const t=_[e.id];return!(!t||!t.length)&&_[e.id].some(e=>i.includes((0,r.m)(e.entity_id)))})),l&&(f=f.filter(e=>{const t=_[e.id];return!t||!t.length||v.every(e=>!l.includes((0,r.m)(e.entity_id)))})),u&&(f=f.filter(e=>!u.includes(e.id))),c&&(f=f.filter(t=>{const i=_[t.id];return!(!i||!i.length)&&_[t.id].some(t=>{const i=e.states[t.entity_id];return!!i&&(i.attributes.device_class&&c.includes(i.attributes.device_class))})})),p&&(f=f.filter(t=>{const i=_[t.id];return!(!i||!i.length)&&i.some(t=>{const i=e.states[t.entity_id];return!!i&&p(i)})})),h&&(f=f.filter(e=>e.id===m||h(e)));return f.map(i=>{const r=(0,a.T)(i,e,_[i.id]),{area:d}=(0,n.w)(i,e),l=d?(0,s.A)(d):void 0,c=i.primary_config_entry?t?.[i.primary_config_entry]:void 0,h=c?.domain,p=h?(0,o.p$)(e.localize,h):void 0,u=r||e.localize("ui.components.device-picker.unnamed_device");return{id:`${y}${i.id}`,label:"",primary:u,secondary:l,domain:c?.domain,domain_name:p,search_labels:{deviceName:r,areaName:l||null,domain:h||null,domainName:p||null},sorting_label:[u,l,p].filter(Boolean).join("_")}})}},53756(e,t,i){i.d(t,{t:()=>d,w:()=>l});i(18111),i(22489),i(61701);var s=i(71727),a=i(74705),r=i(28978),n=i(15638),o=i(95350);const d=[{name:"search_labels.entityName",weight:10},{name:"search_labels.friendlyName",weight:8},{name:"search_labels.deviceName",weight:7},{name:"search_labels.areaName",weight:6},{name:"search_labels.domainName",weight:6},{name:"search_labels.entityId",weight:3}],l=(e,t,i,d,l,c,h,p,u,m="")=>{let y=[],g=Object.keys(e.states);return h&&(g=g.filter(e=>h.includes(e))),p&&(g=g.filter(e=>!p.includes(e))),t&&(g=g.filter(e=>t.includes((0,s.m)(e)))),i&&(g=g.filter(e=>!i.includes((0,s.m)(e)))),y=g.map(t=>{const i=e.states[t],d=(0,r.u)(i),[l,c,h]=(0,a.Cf)(i,[{type:"entity"},{type:"device"},{type:"area"}],e.entities,e.devices,e.areas,e.floors),p=(0,o.p$)(e.localize,(0,s.m)(t)),u=(0,n.qC)(e),y=l||c||t,g=[h,l?c:void 0].filter(Boolean).join(u?" ◂ ":" ▸ ");return{id:`${m}${t}`,primary:y,secondary:g,domain_name:p,sorting_label:[y,g].filter(Boolean).join("_"),search_labels:{entityName:l||null,deviceName:c||null,areaName:h||null,domainName:p||null,friendlyName:d||null,entityId:t},stateObj:i}}),l&&(y=y.filter(e=>e.id===u||e.stateObj?.attributes.device_class&&l.includes(e.stateObj.attributes.device_class))),c&&(y=y.filter(e=>e.id===u||e.stateObj?.attributes.unit_of_measurement&&c.includes(e.stateObj.attributes.unit_of_measurement))),d&&(y=y.filter(e=>e.id===u||e.stateObj&&d(e.stateObj))),y}},55053(e,t,i){i.d(t,{c:()=>r});const s=async(e,t,i,a,r,...n)=>{const o=r,d=o[e],l=d=>a&&a(r,d.result)!==d.cacheKey?(o[e]=void 0,s(e,t,i,a,r,...n)):d.result;if(d)return d instanceof Promise?d.then(l):l(d);const c=i(r,...n);return o[e]=c,c.then(i=>{o[e]={result:i,cacheKey:a?.(r,i)},setTimeout(()=>{o[e]=void 0},t)},()=>{o[e]=void 0}),c},a=e=>e.callWS({type:"entity/source"}),r=e=>s("_entitySources",3e4,a,e=>Object.keys(e.states).length,e)},95350(e,t,i){i.d(t,{QC:()=>r,fK:()=>a,p$:()=>s});const s=(e,t,i)=>e(`component.${t}.title`)||i?.name||t,a=(e,t)=>{const i={type:"manifest/list"};return t&&(i.integrations=t),e.callWS(i)},r=(e,t)=>e.callWS({type:"manifest/get",integration:t})},5904(e,t,i){i.d(t,{I:()=>n,u:()=>r});i(18111),i(81148),i(22489),i(7588),i(61701),i(13579),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698);var s=i(71727),a=i(44927);const r=[{name:"search_labels.name",weight:10},{name:"search_labels.description",weight:5},{name:"search_labels.id",weight:4}],n=(e,t,i,r,n,o,d,l,c,h,p,u="")=>{if(!n||0===n.length)return[];const m=Object.values(i),y=Object.values(r);let g,v,_={};(o||d||l||c||h)&&(_=(0,a.g2)(y),g=m,v=y.filter(e=>e.labels.length>0),o&&(g=g.filter(e=>{const t=_[e.id];return!(!t||!t.length)&&_[e.id].some(e=>o.includes((0,s.m)(e.entity_id)))}),v=v.filter(e=>o.includes((0,s.m)(e.entity_id)))),d&&(g=g.filter(e=>{const t=_[e.id];return!t||!t.length||y.every(e=>!d.includes((0,s.m)(e.entity_id)))}),v=v.filter(e=>!d.includes((0,s.m)(e.entity_id)))),l&&(g=g.filter(t=>{const i=_[t.id];return!(!i||!i.length)&&_[t.id].some(t=>{const i=e[t.entity_id];return!!i&&(i.attributes.device_class&&l.includes(i.attributes.device_class))})}),v=v.filter(t=>{const i=e[t.entity_id];return i&&i.attributes.device_class&&l.includes(i.attributes.device_class)})),c&&(g=g.filter(e=>c(e))),h&&(g=g.filter(t=>{const i=_[t.id];return!(!i||!i.length)&&_[t.id].some(t=>{const i=e[t.entity_id];return!!i&&h(i)})}),v=v.filter(t=>{const i=e[t.entity_id];return!!i&&h(i)})));let f=n;const b=new Set;let $;g&&($=g.filter(e=>e.area_id).map(e=>e.area_id),g.forEach(e=>{e.labels.forEach(e=>b.add(e))})),v&&($=($??[]).concat(v.filter(e=>e.area_id).map(e=>e.area_id)),v.forEach(e=>{e.labels.forEach(e=>b.add(e))})),$&&$.forEach(e=>{const i=t[e];i?.labels.forEach(e=>b.add(e))}),p&&(f=f.filter(e=>!p.includes(e.label_id))),(g||v)&&(f=f.filter(e=>b.has(e.label_id)));return f.map(e=>({id:`${u}${e.label_id}`,primary:e.name,secondary:e.description??"",icon:e.icon||void 0,icon_path:e.icon?void 0:"M17.63,5.84C17.27,5.33 16.67,5 16,5H5A2,2 0 0,0 3,7V17A2,2 0 0,0 5,19H16C16.67,19 17.27,18.66 17.63,18.15L22,12L17.63,5.84Z",sorting_label:e.name,search_labels:{name:e.name,description:e.description,id:e.label_id}}))}},88555(e,t,i){i.d(t,{F7:()=>r,G_:()=>a,Kx:()=>l,Ly:()=>c,OJ:()=>p,YK:()=>h,j_:()=>d,oV:()=>n,vN:()=>o});i(18111),i(22489),i(13579);var s=i(71727);const a="________",r=async(e,t)=>e.callWS({type:"extract_from_target",target:t}),n=async(e,t,i=!0)=>e({type:"get_triggers_for_target",target:t,expand_group:i}),o=async(e,t,i=!0)=>e({type:"get_conditions_for_target",target:t,expand_group:i}),d=async(e,t,i=!0)=>e({type:"get_services_for_target",target:t,expand_group:i}),l=(e,t,i,s,a,r,n,o)=>{if(Object.values(t).filter(t=>t.area_id===e.area_id).some(e=>c(e,i,s,a,r,n,o)))return!0;return!!Object.values(i).filter(t=>t.area_id===e.area_id).some(e=>h(e,!1,a,r,n,o))},c=(e,t,i,s,a,r,n)=>!!Object.values(t).filter(t=>t.device_id===e.id).some(e=>h(e,!1,s,a,r,n))&&(!i||i(e)),h=(e,t=!1,i,a,r,n)=>{if(e.hidden||e.entity_category&&!t)return!1;if(i&&!i.includes((0,s.m)(e.entity_id)))return!1;if(a){const t=r?.[e.entity_id];if(!t)return!1;if(!t.attributes.device_class||!a.includes(t.attributes.device_class))return!1}if(n){const t=r?.[e.entity_id];return!!t&&n(t)}return!0},p=e=>"area"===e.type||"floor"===e.type?e.type:"domain"in e?"device":"stateObj"in e?"entity":"___EMPTY_SEARCH___"===e.id?"empty":"label"},54706(e,t,i){i.d(t,{E:()=>r});i(18111),i(13579);var s=i(62826),a=i(77845);const r=e=>{class t extends e{connectedCallback(){super.connectedCallback(),this._checkSubscribed()}disconnectedCallback(){if(super.disconnectedCallback(),this.__unsubs){for(;this.__unsubs.length;){const e=this.__unsubs.pop();e instanceof Promise?e.then(e=>e()):e()}this.__unsubs=void 0}}updated(e){if(super.updated(e),e.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const t of e.keys())if(this.hassSubscribeRequiredHostProps.includes(t))return void this._checkSubscribed()}hassSubscribe(){return[]}_checkSubscribed(){void 0===this.__unsubs&&this.isConnected&&void 0!==this.hass&&!this.hassSubscribeRequiredHostProps?.some(e=>void 0===this[e])&&(this.__unsubs=this.hassSubscribe())}}return(0,s.Cg)([(0,a.MZ)({attribute:!1})],t.prototype,"hass",void 0),t}},19711(e,t,i){i.d(t,{$:()=>r});var s=i(1087);const a=()=>Promise.all([i.e("3785"),i.e("1046")]).then(i.bind(i,79029)),r=(e,t)=>{(0,s.r)(e,"show-dialog",{dialogTag:"dialog-helper-detail",dialogImport:a,dialogParams:t})}},44144(e,t,i){i.d(t,{MR:()=>s,a_:()=>a,bg:()=>r});const s=e=>`https://brands.home-assistant.io/${e.brand?"brands/":""}${e.useFallback?"_/":""}${e.domain}/${e.darkOptimized?"dark_":""}${e.type}.png`,a=e=>e.split("/")[4],r=e=>e.startsWith("https://brands.home-assistant.io/")}};
//# sourceMappingURL=8142.b4ddb4483695a847.js.map