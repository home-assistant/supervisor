"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["9285"],{19124:function(e,t,n){n.a(e,async function(e,s){try{n.r(t);var r,a,i,o,c,u,h=n(61397),d=n(50264),l=n(72153),p=n(44734),f=n(43080),v=n(69683),g=n(6454),_=n(25460),m=(n(28706),n(74423),n(23792),n(26099),n(3362),n(47764),n(62953),n(62826)),b=n(96196),k=n(77845),y=n(1087),A=n(91926),w=n(6030),x=n(12587),T=(n(50888),n(22130)),z=n(47351),C=n(38395),K=n(65063),M=n(23296),S=(n(81310),e([M]));M=(S.then?(await S)():S)[0];var D=function(e){function t(){var e;(0,p.A)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=(0,v.A)(this,t,[].concat(s))).ingressPanel=!1,e.narrow=!1,e}return(0,g.A)(t,e),(0,f.A)(t,[{key:"disconnectedCallback",value:function(){(0,_.A)(t,"disconnectedCallback",this,3)([]),this._sessionKeepAlive&&(clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=void 0),this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0)}},{key:"render",value:function(){if(!this._addon)return(0,b.qy)(r||(r=(0,l.A)(['<hass-loading-screen .message="','"></hass-loading-screen>'])),this._loadingMessage);var e=(0,b.qy)(a||(a=(0,l.A)(['<iframe title="','" src="','" @load="','"> </iframe>'])),this._addon.name,this._addon.ingress_url,this._checkLoaded);return this.ingressPanel?(0,b.qy)(o||(o=(0,l.A)(["",""])),this.narrow||"always_hidden"===this.hass.dockedSidebar?(0,b.qy)(c||(c=(0,l.A)(['<div class="header"> <ha-icon-button .label="','" .path="','" @click="','"></ha-icon-button> <div class="main-title">',"</div> </div> ",""])),this.hass.localize("ui.sidebar.sidebar_toggle"),"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z",this._toggleMenu,this._addon.name,e):e):(0,b.qy)(i||(i=(0,l.A)(['<hass-subpage .hass="','" .header="','" .narrow="','"> '," </hass-subpage>"])),this.hass,this._addon.name,this.narrow,e)}},{key:"firstUpdated",value:(u=(0,d.A)((0,h.A)().m(function e(){var t,n,s;return(0,h.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(""!==this.route.path){e.n=13;break}if(!(t=(0,w.p9)("addon"))){e.n=13;break}return e.p=1,e.n=2,(0,T.wj)(this.hass,t);case 2:n=e.v,e.n=6;break;case 3:return e.p=3,s=e.v,e.n=4,(0,K.K$)(this,{text:(0,z.VR)(s),title:t});case 4:return e.n=5,(0,x.E)();case 5:return(0,A.o)("/hassio/store",{replace:!0}),e.a(2);case 6:if(n.version){e.n=9;break}return e.n=7,(0,K.K$)(this,{text:this.supervisor.localize("my.error_addon_not_installed"),title:n.name});case 7:return e.n=8,(0,x.E)();case 8:(0,A.o)("/hassio/addon/".concat(n.slug,"/info"),{replace:!0}),e.n=13;break;case 9:if(n.ingress){e.n=12;break}return e.n=10,(0,K.K$)(this,{text:this.supervisor.localize("my.error_addon_no_ingress"),title:n.name});case 10:return e.n=11,(0,x.E)();case 11:(0,A.o)("/hassio/addon/".concat(n.slug,"/info"),{replace:!0}),e.n=13;break;case 12:(0,A.o)("/hassio/ingress/".concat(n.slug),{replace:!0});case 13:return e.a(2)}},e,this,[[1,3]])})),function(){return u.apply(this,arguments)})},{key:"willUpdate",value:function(e){if((0,_.A)(t,"willUpdate",this,3)([e]),e.has("route")){var n=this.route.path.substring(1),s=e.get("route"),r=s?s.path.substring(1):void 0;n&&n!==r&&(this._loadingMessage=void 0,this._fetchData(n))}}},{key:"_fetchData",value:(s=(0,d.A)((0,h.A)().m(function e(t){var n,s,r,a=this;return(0,h.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=(0,C.q)(this.hass),e.p=1,e.n=2,(0,T.wj)(this.hass,t);case 2:s=e.v,e.n=7;break;case 3:return e.p=3,e.v,e.n=4,this.updateComplete;case 4:return e.n=5,(0,K.K$)(this,{text:this.supervisor.localize("ingress.error_addon_info")||"Unable to fetch add-on info to start Ingress",title:"Supervisor"});case 5:return e.n=6,(0,x.E)();case 6:return(0,A.o)("/hassio/store",{replace:!0}),e.a(2);case 7:if(s.version){e.n=11;break}return e.n=8,this.updateComplete;case 8:return e.n=9,(0,K.K$)(this,{text:this.supervisor.localize("ingress.error_addon_not_installed")||"The add-on is not installed. Please install it first",title:s.name});case 9:return e.n=10,(0,x.E)();case 10:return(0,A.o)("/hassio/addon/".concat(s.slug,"/info"),{replace:!0}),e.a(2);case 11:if(s.ingress_url){e.n=15;break}return e.n=12,this.updateComplete;case 12:return e.n=13,(0,K.K$)(this,{text:this.supervisor.localize("ingress.error_addon_not_supported")||"This add-on does not support Ingress",title:s.name});case 13:return e.n=14,(0,x.E)();case 14:return(0,A.O)(),e.a(2);case 15:if(s.state&&["startup","started"].includes(s.state)){e.n=25;break}return e.n=16,this.updateComplete;case 16:return e.n=17,(0,K.dk)(this,{text:this.supervisor.localize("ingress.error_addon_not_running")||"The add-on is not running. Do you want to start it now?",title:s.name,confirmText:this.supervisor.localize("ingress.start_addon")||"Start add-on",dismissText:this.supervisor.localize("common.no")||"No"});case 17:if(!e.v){e.n=23;break}return e.p=18,this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",e.n=19,(0,T.eK)(this.hass,t);case 19:return(0,y.r)(this,"supervisor-collection-refresh",{collection:"addon"}),this._fetchData(t),e.a(2);case 20:return e.p=20,e.v,e.n=21,(0,K.K$)(this,{text:this.supervisor.localize("ingress.error_starting_addon")||"Error starting the add-on",title:s.name});case 21:return e.n=22,(0,x.E)();case 22:return(0,A.o)("/hassio/addon/".concat(s.slug,"/logs"),{replace:!0}),e.a(2);case 23:return e.n=24,(0,x.E)();case 24:return(0,A.o)("/hassio/addon/".concat(s.slug,"/info"),{replace:!0}),e.a(2);case 25:if("startup"!==s.state){e.n=26;break}return this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",this._fetchDataTimeout=window.setTimeout(function(){a._fetchData(t)},500),e.a(2);case 26:if("started"===s.state){e.n=27;break}return e.a(2);case 27:return this._loadingMessage=void 0,this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0),e.p=28,e.n=29,n;case 29:r=e.v,e.n=33;break;case 30:return e.p=30,e.v,this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),e.n=31,(0,K.K$)(this,{text:this.supervisor.localize("ingress.error_creating_session")||"Unable to create an Ingress session",title:s.name});case 31:return e.n=32,(0,x.E)();case 32:return(0,A.O)(),e.a(2);case 33:this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=window.setInterval((0,d.A)((0,h.A)().m(function e(){return(0,h.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,C.k)(a.hass,r);case 1:e.n=4;break;case 2:return e.p=2,e.v,e.n=3,(0,C.q)(a.hass);case 3:r=e.v;case 4:return e.a(2)}},e,null,[[0,2]])})),6e4),this._addon=s;case 34:return e.a(2)}},e,this,[[28,30],[18,20],[1,3]])})),function(e){return s.apply(this,arguments)})},{key:"_checkLoaded",value:(n=(0,d.A)((0,h.A)().m(function e(t){var n=this;return(0,h.A)().w(function(e){for(;;)switch(e.n){case 0:if(this._addon){e.n=1;break}return e.a(2);case 1:if("502: Bad Gateway"!==t.target.contentDocument.body.textContent){e.n=3;break}return e.n=2,this.updateComplete;case 2:(0,K.dk)(this,{text:this.supervisor.localize("ingress.error_addon_not_ready")||"The add-on seems to not be ready, it might still be starting. Do you want to try again?",title:this._addon.name,confirmText:this.supervisor.localize("ingress.retry")||"Retry",dismissText:this.supervisor.localize("common.no")||"No",confirm:function(){var e=(0,d.A)((0,h.A)().m(function e(){var t;return(0,h.A)().w(function(e){for(;;)switch(e.n){case 0:return t=n._addon,n._addon=void 0,e.n=1,Promise.all([n.updateComplete,new Promise(function(e){setTimeout(e,500)})]);case 1:n._addon=t;case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}()});case 3:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_toggleMenu",value:function(){(0,y.r)(this,"hass-toggle-menu")}}]);var n,s,u}(b.WF);D.styles=(0,b.AH)(u||(u=(0,l.A)(["iframe{display:block;width:100%;height:100%;border:0}.header+iframe{height:calc(100% - 40px)}.header{display:flex;align-items:center;font-size:var(--ha-font-size-l);height:40px;padding:0 16px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box;--mdc-icon-size:20px}.main-title{margin:var(--margin-title);line-height:var(--ha-line-height-condensed);flex-grow:1}ha-icon-button{pointer-events:auto}hass-subpage{--app-header-background-color:var(--sidebar-background-color);--app-header-text-color:var(--sidebar-text-color);--app-header-border-bottom:1px solid var(--divider-color)}"]))),(0,m.Cg)([(0,k.MZ)({attribute:!1})],D.prototype,"hass",void 0),(0,m.Cg)([(0,k.MZ)({attribute:!1})],D.prototype,"supervisor",void 0),(0,m.Cg)([(0,k.MZ)({attribute:!1})],D.prototype,"route",void 0),(0,m.Cg)([(0,k.MZ)({attribute:!1})],D.prototype,"ingressPanel",void 0),(0,m.Cg)([(0,k.MZ)({type:Boolean})],D.prototype,"narrow",void 0),(0,m.Cg)([(0,k.wk)()],D.prototype,"_addon",void 0),(0,m.Cg)([(0,k.wk)()],D.prototype,"_loadingMessage",void 0),D=(0,m.Cg)([(0,k.EM)("hassio-ingress-view")],D),s()}catch(E){s(E)}})},6030:function(e,t,n){n.d(t,{KH:function(){return c},p9:function(){return o},px:function(){return i}});var s=n(78261),r=n(31432),a=(n(23792),n(18111),n(7588),n(5506),n(26099),n(27495),n(38781),n(47764),n(5746),n(23500),n(62953),n(48408),n(14603),n(47566),n(98721),n(19422)),i=function(){var e,t={},n=new URLSearchParams(a.G.location.search),i=(0,r.A)(n.entries());try{for(i.s();!(e=i.n()).done;){var o=(0,s.A)(e.value,2),c=o[0],u=o[1];t[c]=u}}catch(h){i.e(h)}finally{i.f()}return t},o=function(e){return new URLSearchParams(a.G.location.search).get(e)},c=function(e){var t=new URLSearchParams;return Object.entries(e).forEach(function(e){var n=(0,s.A)(e,2),r=n[0],a=n[1];t.append(r,a)}),t.toString()}},38395:function(e,t,n){n.d(t,{k:function(){return c},q:function(){return o}});var s=n(61397),r=n(50264),a=(n(28706),n(62384));function i(e){return document.cookie="ingress_session=".concat(e,";path=/api/hassio_ingress/;SameSite=Strict").concat("https:"===location.protocol?";Secure":""),e}var o=function(){var e=(0,r.A)((0,s.A)().m(function e(t){var n,r;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(!(0,a.v)(t.config.version,2021,2,4)){e.n=2;break}return e.n=1,t.callWS({type:"supervisor/api",endpoint:"/ingress/session",method:"post"});case 1:return n=e.v,e.a(2,i(n.session));case 2:return e.n=3,t.callApi("POST","hassio/ingress/session");case 3:return r=e.v,e.a(2,i(r.data.session))}},e)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,r.A)((0,s.A)().m(function e(t,n){return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(!(0,a.v)(t.config.version,2021,2,4)){e.n=2;break}return e.n=1,t.callWS({type:"supervisor/api",endpoint:"/ingress/validate_session",method:"post",data:{session:n}});case 1:case 3:return e.a(2);case 2:return e.n=3,t.callApi("POST","hassio/ingress/validate_session",{session:n})}},e)}));return function(t,n){return e.apply(this,arguments)}}()},5506:function(e,t,n){var s=n(46518),r=n(32357).entries;s({target:"Object",stat:!0},{entries:function(e){return r(e)}})}}]);
//# sourceMappingURL=9285.ee37588b4ecc4f72.js.map